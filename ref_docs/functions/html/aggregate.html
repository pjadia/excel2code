<article class="ocpArticleContent">
 <section class="ocpIntroduction">
  <p>
   Returns an aggregate in a list or database. The AGGREGATE function can apply different aggregate functions to a list or database with the option to ignore hidden rows and error values.
  </p>
 </section>
 <section aria-labelledby="ID0EFH" class="ocpSection">
  <h2 class="" id="ID0EFH">
   Syntax
  </h2>
  <section aria-labelledby="ID0EFDBH" class="ocpSection">
   <h3 class="" id="ID0EFDBH">
    Reference form
   </h3>
   <p>
    AGGREGATE(function_num, options, ref1, [ref2], â€¦)
   </p>
  </section>
  <section aria-labelledby="ID0EFBBH" class="ocpSection">
   <h3 class="" id="ID0EFBBH">
    Array form
   </h3>
   <p>
    AGGREGATE(function_num, options, array, [k])
   </p>
   <p>
    The AGGREGATE function syntax has the following arguments:
   </p>
   <ul>
    <li>
     <p>
      <b class="ocpRunInHead">
       Function_num
      </b>
      Required. A number 1 to 19 that specifies which function to use.
     </p>
    </li>
   </ul>
   <table aria-label="" class="banded">
    <thead>
     <tr>
      <td>
       <p>
        <b class="ocpLegacyBold">
         Function_num
        </b>
       </p>
      </td>
      <td>
       <p>
        <b class="ocpLegacyBold">
         Function
        </b>
       </p>
      </td>
     </tr>
    </thead>
    <tbody>
     <tr>
      <td>
       <p>
        1
       </p>
      </td>
      <td>
       <p>
        AVERAGE
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        2
       </p>
      </td>
      <td>
       <p>
        COUNT
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        3
       </p>
      </td>
      <td>
       <p>
        COUNTA
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        4
       </p>
      </td>
      <td>
       <p>
        MAX
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        5
       </p>
      </td>
      <td>
       <p>
        MIN
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        6
       </p>
      </td>
      <td>
       <p>
        PRODUCT
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        7
       </p>
      </td>
      <td>
       <p>
        STDEV.S
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        8
       </p>
      </td>
      <td>
       <p>
        STDEV.P
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        9
       </p>
      </td>
      <td>
       <p>
        SUM
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        10
       </p>
      </td>
      <td>
       <p>
        VAR.S
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        11
       </p>
      </td>
      <td>
       <p>
        VAR.P
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        12
       </p>
      </td>
      <td>
       <p>
        MEDIAN
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        13
       </p>
      </td>
      <td>
       <p>
        MODE.SNGL
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        14
       </p>
      </td>
      <td>
       <p>
        LARGE
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        15
       </p>
      </td>
      <td>
       <p>
        SMALL
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        16
       </p>
      </td>
      <td>
       <p>
        PERCENTILE.INC
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        17
       </p>
      </td>
      <td>
       <p>
        QUARTILE.INC
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        18
       </p>
      </td>
      <td>
       <p>
        PERCENTILE.EXC
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        19
       </p>
      </td>
      <td>
       <p>
        QUARTILE.EXC
       </p>
      </td>
     </tr>
    </tbody>
   </table>
   <ul>
    <li>
     <p>
      <b class="ocpRunInHead">
       Options
      </b>
      Required. A numerical value that determines which values to ignore in the evaluation range for the function.
     </p>
     <div class="ocpAlert">
      <p class="ocpAlertSection">
       <b class="ocpNote">
        Note:
       </b>
       The function will not ignore hidden rows, nested subtotals or nested aggregates if the array argument includes a calculation, for example:
       <b class="ocpLiteral">
        =AGGREGATE(14,3,A1:A100*(A1:A100&gt;0),1)
       </b>
      </p>
     </div>
    </li>
   </ul>
   <table aria-label="" class="banded">
    <thead>
     <tr>
      <td>
       <p>
        <b class="ocpLegacyBold">
         Option
        </b>
       </p>
      </td>
      <td>
       <p>
        <b class="ocpLegacyBold">
         Behavior
        </b>
       </p>
      </td>
     </tr>
    </thead>
    <tbody>
     <tr>
      <td>
       <p>
        0 or omitted
       </p>
      </td>
      <td>
       <p>
        Ignore nested SUBTOTAL and AGGREGATE functions
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        1
       </p>
      </td>
      <td>
       <p>
        Ignore hidden rows, nested SUBTOTAL and AGGREGATE functions
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        2
       </p>
      </td>
      <td>
       <p>
        Ignore error values, nested SUBTOTAL and AGGREGATE functions
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        3
       </p>
      </td>
      <td>
       <p>
        Ignore hidden rows, error values, nested SUBTOTAL and AGGREGATE functions
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        4
       </p>
      </td>
      <td>
       <p>
        Ignore nothing
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        5
       </p>
      </td>
      <td>
       <p>
        Ignore hidden rows
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        6
       </p>
      </td>
      <td>
       <p>
        Ignore error values
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        7
       </p>
      </td>
      <td>
       <p>
        Ignore hidden rows and error values
       </p>
      </td>
     </tr>
    </tbody>
   </table>
   <ul>
    <li>
     <p>
      <b class="ocpRunInHead">
       Ref1
      </b>
      Required. The first numeric argument for functions that take multiple numeric arguments for which you want the aggregate value.
     </p>
    </li>
    <li>
     <p>
      <b class="ocpRunInHead">
       Ref2,...
      </b>
      Optional. Numeric arguments 2 to 253 for which you want the aggregate value.
     </p>
     <p>
      For functions that take an array, ref1 is an array, an array formula, or a reference to a range of cells for which you want the aggregate value. Ref2 is a second argument that is required for certain functions. The following functions require a ref2 argument:
     </p>
    </li>
   </ul>
   <table aria-label="" class="banded">
    <thead>
     <tr>
      <td>
       <p>
        <b class="ocpLegacyBold">
         Function
        </b>
       </p>
      </td>
     </tr>
    </thead>
    <tbody>
     <tr>
      <td>
       <p>
        LARGE(array,k)
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        SMALL(array,k)
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        PERCENTILE.INC(array,k)
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        QUARTILE.INC(array,quart)
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        PERCENTILE.EXC(array,k)
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        QUARTILE.EXC(array,quart)
       </p>
      </td>
     </tr>
    </tbody>
   </table>
  </section>
 </section>
 <section aria-labelledby="ID0EFF" class="ocpSection">
  <h2 class="" id="ID0EFF">
   Remarks
  </h2>
  <p>
   <b class="ocpLegacyBold">
    Function_num
   </b>
   <b class="ocpLegacyBold">
    :
   </b>
  </p>
  <ul>
   <li>
    <p>
     As soon as you type the function_num argument when you enter the AGGREGATE function into a cell on the worksheet, you will see a list of all functions that you can use as arguments.
    </p>
   </li>
  </ul>
  <p>
   Errors:
  </p>
  <ul>
   <li>
    <p>
     If a second ref argument is required but not provided, AGGREGATE returns a #VALUE! error.
    </p>
   </li>
   <li>
    <p>
     If one or more of the references are 3-D references, AGGREGATE returns the #VALUE! error value.
    </p>
   </li>
  </ul>
  <p>
   Type of Range:
  </p>
  <ul>
   <li>
    <p>
     The AGGREGATE function is designed for columns of data, or vertical ranges. It is not designed for rows of data, or horizontal ranges. For example, when you subtotal a horizontal range using option 1, such as AGGREGATE(1, 1, ref1), hiding a column does not affect the aggregate sum value. But, hiding a row in vertical range does affect the aggregate.
    </p>
   </li>
  </ul>
 </section>
 <section aria-labelledby="ID0EFD" class="ocpSection">
  <h2 class="" id="ID0EFD">
   Example
  </h2>
  <p>
   Copy the example data in the following table, and paste it in cell A1 of a new Excel worksheet. For formulas to show results, select them, press F2, and then press Enter. If you need to, you can adjust the column widths to see all the data.
  </p>
  <table aria-label="" class="banded">
   <thead>
    <tr>
     <td>
      <p>
       #DIV/0!
      </p>
     </td>
     <td>
      <p>
       82
      </p>
     </td>
     <td>
     </td>
    </tr>
   </thead>
   <tbody>
    <tr>
     <td>
      <p>
       72
      </p>
     </td>
     <td>
      <p>
       65
      </p>
     </td>
     <td>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       30
      </p>
     </td>
     <td>
      <p>
       95
      </p>
     </td>
     <td>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       #NUM!
      </p>
     </td>
     <td>
      <p>
       63
      </p>
     </td>
     <td>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       31
      </p>
     </td>
     <td>
      <p>
       53
      </p>
     </td>
     <td>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       96
      </p>
     </td>
     <td>
      <p>
       71
      </p>
     </td>
     <td>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       32
      </p>
     </td>
     <td>
      <p>
       55
      </p>
     </td>
     <td>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       81
      </p>
     </td>
     <td>
      <p>
       83
      </p>
     </td>
     <td>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       33
      </p>
     </td>
     <td>
      <p>
       100
      </p>
     </td>
     <td>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       53
      </p>
     </td>
     <td>
      <p>
       91
      </p>
     </td>
     <td>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       34
      </p>
     </td>
     <td>
      <p>
       89
      </p>
     </td>
     <td>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       <b class="ocpLegacyBold">
        Formula
       </b>
      </p>
     </td>
     <td>
      <p>
       <b class="ocpLegacyBold">
        Description
       </b>
      </p>
     </td>
     <td>
      <p>
       <b class="ocpLegacyBold">
        Result
       </b>
      </p>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       =AGGREGATE(4, 6, A1:A11)
      </p>
     </td>
     <td>
      <p>
       Calculates the maximum value while ignoring error values in the range
      </p>
     </td>
     <td>
      <p>
       96
      </p>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       =AGGREGATE(14, 6, A1:A11, 3)
      </p>
     </td>
     <td>
      <p>
       Calculates the 3rd largest value while ignoring error values in the range
      </p>
     </td>
     <td>
      <p>
       72
      </p>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       =AGGREGATE(15, 6, A1:A11)
      </p>
     </td>
     <td>
      <p>
       Will return #VALUE! error. This is because AGGREGATE is expecting a second ref argument, since the function (SMALL) requires one.
      </p>
     </td>
     <td>
      <p>
       #VALUE!
      </p>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       =AGGREGATE(12, 6, A1:A11, B1:B11)
      </p>
     </td>
     <td>
      <p>
       Calculates the median while ignoring error values in the range
      </p>
     </td>
     <td>
      <p>
       68
      </p>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       =MAX(A1:A2)
      </p>
     </td>
     <td>
      <p>
       Will return error value, since there are error values in the evaluation range.
      </p>
     </td>
     <td>
      <p>
       #DIV/0!
      </p>
     </td>
    </tr>
   </tbody>
  </table>
 </section>
</article>
