<article class="ocpArticleContent">
 <section class="ocpIntroduction">
  <p>
   The SORTBY function sorts the contents of a range or array based on the values in a corresponding range or array.
  </p>
  <div class="ocpVideo" data-channel="ALTENUS_MS_OFFICE" data-llcc="en-us" data-player="ocvideo" data-videoid="RE2IO3X" data-videotitle="SORTBY function" data-videotype="single" id="ocpVideo1">
   <universal-media-player options='{"partnerName":"SupportService","autoplay":false,"reporting":false,"language":"en-us","title":"SORTBY function","poster":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-1fdbafc3-5266-4f07-90bc-0f4579c2c88a/thumbnail_w800.png","sources":[{"type":"MP4","quality":"HQ","src":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-1fdbafc3-5266-4f07-90bc-0f4579c2c88a/video_1001_1730344879029_1920x1080.mp4"},{"type":"MP4","quality":"HD","src":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-1fdbafc3-5266-4f07-90bc-0f4579c2c88a/video_1001_1730344879029_1280x720.mp4"},{"type":"MP4","quality":"LO","src":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-1fdbafc3-5266-4f07-90bc-0f4579c2c88a/video_1001_1730344879029_640x360.mp4"},{"type":"DASH","src":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-1fdbafc3-5266-4f07-90bc-0f4579c2c88a/video_1001_1730344879029.mpd"},{"type":"HLS","src":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-1fdbafc3-5266-4f07-90bc-0f4579c2c88a/video_1001_1730344879029_master.m3u8"}],"ccFiles":[{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-1fdbafc3-5266-4f07-90bc-0f4579c2c88a/en_us_en-us.vtt","locale":"en-us","ccType":"VTT"}]}'>
    <picture>
     <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=avif&amp;w=320 320w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=avif&amp;w=480 480w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=avif&amp;w=640 640w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=avif&amp;w=800 800w" type="image/avif"/>
     <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=webp&amp;w=320 320w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=webp&amp;w=480 480w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=webp&amp;w=640 640w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=webp&amp;w=800 800w" type="image/webp"/>
     <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=jpeg&amp;w=320 320w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=jpeg&amp;w=480 480w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=jpeg&amp;w=640 640w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
     <img alt="Your browser does not support video. Install Microsoft Silverlight, Adobe Flash Player, or Internet Explorer 9." class="fluentImage" loading="lazy" src="/images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7" style="aspect-ratio: 960/540" width="960"/>
    </picture>
   </universal-media-player>
  </div>
  <p>
   In this example, we're sorting a list of people's names by their age, in ascending order.
  </p>
  <p>
   <picture>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/3fb4172f-f2d6-4918-ae36-12ca33fe3cb2?format=avif&amp;w=320 320w,        /images/en-us/3fb4172f-f2d6-4918-ae36-12ca33fe3cb2?format=avif&amp;w=480 480w,        /images/en-us/3fb4172f-f2d6-4918-ae36-12ca33fe3cb2?format=avif&amp;w=640 640w,        /images/en-us/3fb4172f-f2d6-4918-ae36-12ca33fe3cb2?format=avif&amp;w=800 800w" type="image/avif"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/3fb4172f-f2d6-4918-ae36-12ca33fe3cb2?format=webp&amp;w=320 320w,        /images/en-us/3fb4172f-f2d6-4918-ae36-12ca33fe3cb2?format=webp&amp;w=480 480w,        /images/en-us/3fb4172f-f2d6-4918-ae36-12ca33fe3cb2?format=webp&amp;w=640 640w,        /images/en-us/3fb4172f-f2d6-4918-ae36-12ca33fe3cb2?format=webp&amp;w=800 800w" type="image/webp"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/3fb4172f-f2d6-4918-ae36-12ca33fe3cb2?format=jpeg&amp;w=320 320w,        /images/en-us/3fb4172f-f2d6-4918-ae36-12ca33fe3cb2?format=jpeg&amp;w=480 480w,        /images/en-us/3fb4172f-f2d6-4918-ae36-12ca33fe3cb2?format=jpeg&amp;w=640 640w,        /images/en-us/3fb4172f-f2d6-4918-ae36-12ca33fe3cb2?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
    <img alt="Use SORTBY to sort a range. In this case, we used =SORTBY(D2:E9,E2:E9) to sort a list of people's names by their age, in ascending order." class="fluentImage" loading="lazy" src="/images/en-us/3fb4172f-f2d6-4918-ae36-12ca33fe3cb2" style="aspect-ratio: 281/257" width="281"/>
   </picture>
  </p>
 </section>
 <div class="ocpSection">
  <h2 class="ocpExpandoHead">
   <button aria-controls="ID0EL-panel" aria-expanded="false" class="expandoButtonLink" id="ID0EL-button" ms.interactiontype="11" type="button">
    <div aria-hidden="true" class="ocpExpandoHeadChevronContainer">
     <i class="ms-Icon--expandoCollapsed ocpExpander" role="none">
     </i>
    </div>
    <div class="ocpExpandoHeadTitleContainer" role="none">
     Syntax
    </div>
   </button>
  </h2>
  <div aria-labelledby="ID0EL-button" class="ocpebw" id="ID0EL-panel" role="region">
   <div class="ocpExpandoBody">
    <p>
     <b class="ocpLegacyBold">
      =SORTBY(array, by_array1, [sort_order1], [by_array2, sort_order2],…)
     </b>
    </p>
    <table aria-label="" class="banded">
     <thead>
      <tr>
       <th>
        <p>
         Argument
        </p>
       </th>
       <th>
        <p>
         Description
        </p>
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <p>
         <b class="ocpLegacyBold">
          array
         </b>
        </p>
        <p>
         Required
        </p>
       </td>
       <td>
        <p>
         The array or range to sort
        </p>
       </td>
      </tr>
      <tr>
       <td>
        <p>
         <b class="ocpLegacyBold">
          by_array1
         </b>
        </p>
        <p>
         Required
        </p>
       </td>
       <td>
        <p>
         The array or range to sort on
        </p>
       </td>
      </tr>
      <tr>
       <td>
        <p>
         <b class="ocpLegacyBold">
          [sort_order1]
         </b>
        </p>
        <p>
         Optional
        </p>
       </td>
       <td>
        <p>
         The order to use for sorting. 1 for ascending, -1 for descending. Default is ascending.
        </p>
       </td>
      </tr>
      <tr>
       <td>
        <p>
         <b class="ocpLegacyBold">
          [by_array2]
         </b>
        </p>
        <p>
         Optional
        </p>
       </td>
       <td>
        <p>
         The array or range to sort on
        </p>
       </td>
      </tr>
      <tr>
       <td>
        <p>
         <b class="ocpLegacyBold">
          [sort_order2]
         </b>
        </p>
        <p>
         Optional
        </p>
       </td>
       <td>
        <p>
         The order to use for sorting. 1 for ascending, -1 for descending. Default is ascending.
        </p>
       </td>
      </tr>
     </tbody>
    </table>
    <div class="ocpAlert">
     <p class="ocpAlertSection">
      <b class="ocpNote">
       Notes:
      </b>
     </p>
     <ul class="ocpAlertSectionListContainer">
      <li>
       <p>
        An array can be thought of as a row of values, a column of values, or a combination of rows and columns of values. In the example above, the array for our SORTBY formula is range D2:E9.
       </p>
      </li>
      <li>
       <p>
        The SORTBY function will return an array, which will spill if it's the final result of a formula. This means that Excel will dynamically create the appropriate sized array range when you press
        <b class="ocpUI">
         ENTER
        </b>
        . If your supporting data is in an
        <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/overview-of-excel-tables-7ab0bb7d-3a9e-4b56-a3c9-6c94334e492c">
         Excel Table
        </a>
        , then the array will automatically resize as you add or remove data from your array range if you're using
        <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/using-structured-references-with-excel-tables-f5ed2452-2337-4f71-bed3-c8ae6d2b276e">
         Structured References
        </a>
        . For more details, see this article on
        <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/dynamic-array-formulas-and-spilled-array-behavior-205c6b06-03ba-4151-89a1-87a7eb36e531">
         Spilled Array Behavior
        </a>
        .
       </p>
      </li>
      <li>
       <p>
        Excel has limited support for dynamic arrays between workbooks, and this scenario is only supported when
        <b class="ocpLegacyBold">
         both
        </b>
        workbooks are open. If you close the source workbook, any linked dynamic array formulas will return a
        <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/how-to-correct-a-ref-error-822c8e46-e610-4d02-bf29-ec4b8c5ff4be">
         #REF! error
        </a>
        when they are refreshed.
       </p>
      </li>
     </ul>
    </div>
   </div>
  </div>
 </div>
 <section aria-labelledby="ID0EDJ" class="ocpSection">
  <h2 class="" id="ID0EDJ">
   Examples
  </h2>
  <p>
   Sort a table by Region in ascending order, then by each person's age, in descending order.
  </p>
  <p>
   <picture>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/b525f411-f06c-42e5-afbc-31e1be5b1702?format=avif&amp;w=320 320w,        /images/en-us/b525f411-f06c-42e5-afbc-31e1be5b1702?format=avif&amp;w=480 480w,        /images/en-us/b525f411-f06c-42e5-afbc-31e1be5b1702?format=avif&amp;w=640 640w,        /images/en-us/b525f411-f06c-42e5-afbc-31e1be5b1702?format=avif&amp;w=800 800w" type="image/avif"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/b525f411-f06c-42e5-afbc-31e1be5b1702?format=webp&amp;w=320 320w,        /images/en-us/b525f411-f06c-42e5-afbc-31e1be5b1702?format=webp&amp;w=480 480w,        /images/en-us/b525f411-f06c-42e5-afbc-31e1be5b1702?format=webp&amp;w=640 640w,        /images/en-us/b525f411-f06c-42e5-afbc-31e1be5b1702?format=webp&amp;w=800 800w" type="image/webp"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/b525f411-f06c-42e5-afbc-31e1be5b1702?format=jpeg&amp;w=320 320w,        /images/en-us/b525f411-f06c-42e5-afbc-31e1be5b1702?format=jpeg&amp;w=480 480w,        /images/en-us/b525f411-f06c-42e5-afbc-31e1be5b1702?format=jpeg&amp;w=640 640w,        /images/en-us/b525f411-f06c-42e5-afbc-31e1be5b1702?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
    <img alt="Sort a table, by Region in ascending order, then by each person's age, in descending order." class="fluentImage" loading="lazy" src="/images/en-us/b525f411-f06c-42e5-afbc-31e1be5b1702" style="aspect-ratio: 433/237" width="433"/>
   </picture>
  </p>
  <p>
   Use SORTBY with
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/randarray-function-21261e55-3bec-4885-86a6-8b0a47fd4d33">
    RANDARRAY
   </a>
   , and COUNTA to randomize a list of values. In this case, E2# references the dynamic array range beginning in cell E2, as that was populated by using =
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/sequence-function-57467a98-57e0-4817-9f14-2eb78519ca90">
    SEQUENCE
   </a>
   (10). The # sign is called the
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/spilled-range-operator-3dd5899f-bca2-4b9d-a172-3eae9ac22efd">
    spilled range operator
   </a>
   .
  </p>
  <p>
   <picture>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/7f456a72-f518-4219-b44f-070ef77bfd5f?format=avif&amp;w=320 320w,        /images/en-us/7f456a72-f518-4219-b44f-070ef77bfd5f?format=avif&amp;w=480 480w,        /images/en-us/7f456a72-f518-4219-b44f-070ef77bfd5f?format=avif&amp;w=640 640w,        /images/en-us/7f456a72-f518-4219-b44f-070ef77bfd5f?format=avif&amp;w=800 800w" type="image/avif"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/7f456a72-f518-4219-b44f-070ef77bfd5f?format=webp&amp;w=320 320w,        /images/en-us/7f456a72-f518-4219-b44f-070ef77bfd5f?format=webp&amp;w=480 480w,        /images/en-us/7f456a72-f518-4219-b44f-070ef77bfd5f?format=webp&amp;w=640 640w,        /images/en-us/7f456a72-f518-4219-b44f-070ef77bfd5f?format=webp&amp;w=800 800w" type="image/webp"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/7f456a72-f518-4219-b44f-070ef77bfd5f?format=jpeg&amp;w=320 320w,        /images/en-us/7f456a72-f518-4219-b44f-070ef77bfd5f?format=jpeg&amp;w=480 480w,        /images/en-us/7f456a72-f518-4219-b44f-070ef77bfd5f?format=jpeg&amp;w=640 640w,        /images/en-us/7f456a72-f518-4219-b44f-070ef77bfd5f?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
    <img alt="Use SORTBY with RANDARRAY, and COUNTA. In this case, E2# references the entire range beginning in cell E2, as that was populated using =SEQUENCE(10). The # sign is called the spilled range operator." class="fluentImage" loading="lazy" src="/images/en-us/7f456a72-f518-4219-b44f-070ef77bfd5f" style="aspect-ratio: 297/297" width="297"/>
   </picture>
  </p>
  <p>
   Use SORTBY to sort a table of temperature and rainfall values by high temperature.
  </p>
  <p>
   <picture>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/7c02dcad-423a-4579-a1cd-af292b66507c?format=avif&amp;w=320 320w,        /images/en-us/7c02dcad-423a-4579-a1cd-af292b66507c?format=avif&amp;w=480 480w,        /images/en-us/7c02dcad-423a-4579-a1cd-af292b66507c?format=avif&amp;w=640 640w,        /images/en-us/7c02dcad-423a-4579-a1cd-af292b66507c?format=avif&amp;w=800 800w" type="image/avif"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/7c02dcad-423a-4579-a1cd-af292b66507c?format=webp&amp;w=320 320w,        /images/en-us/7c02dcad-423a-4579-a1cd-af292b66507c?format=webp&amp;w=480 480w,        /images/en-us/7c02dcad-423a-4579-a1cd-af292b66507c?format=webp&amp;w=640 640w,        /images/en-us/7c02dcad-423a-4579-a1cd-af292b66507c?format=webp&amp;w=800 800w" type="image/webp"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/7c02dcad-423a-4579-a1cd-af292b66507c?format=jpeg&amp;w=320 320w,        /images/en-us/7c02dcad-423a-4579-a1cd-af292b66507c?format=jpeg&amp;w=480 480w,        /images/en-us/7c02dcad-423a-4579-a1cd-af292b66507c?format=jpeg&amp;w=640 640w,        /images/en-us/7c02dcad-423a-4579-a1cd-af292b66507c?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
    <img alt="Use SORTBY to sort a table of temperature and rainfall values by high temperature." class="fluentImage" loading="lazy" src="/images/en-us/7c02dcad-423a-4579-a1cd-af292b66507c" style="aspect-ratio: 433/275" width="433"/>
   </picture>
  </p>
  <p>
  </p>
 </section>
 <section aria-labelledby="ID0EDH" class="ocpSection">
  <h2 class="" id="ID0EDH">
   Error conditions
  </h2>
  <ul>
   <li>
    <p>
     The by_array arguments must either be one row high, or one column wide.
    </p>
   </li>
   <li>
    <p>
     All of the arguments must be the same size.
    </p>
   </li>
   <li>
    <p>
     If the sort order argument is not -1, or 1, the formula will result in a #VALUE! error. If you leave out the sort order argument, Excel will default to ascending order.
    </p>
   </li>
  </ul>
 </section>
 <section aria-labelledby="ID0EDF" class="ocpSection">
  <h2 class="" id="ID0EDF">
   Need more help?
  </h2>
  <p>
   You can always ask an expert in the
   <a class="ocpExternalLink" data-bi-type="anchor" href="https://techcommunity.microsoft.com/t5/Excel/ct-p/Excel_Cat" target="_blank">
    Excel Tech Community
   </a>
   or get support in
   <a class="ocpExternalLink" data-bi-type="anchor" href="https://answers.microsoft.com/lang/msoffice/forum/msoffice_excel" target="_blank">
    Communities
   </a>
   .
  </p>
  <p>
  </p>
 </section>
 <section aria-labelledby="ID0EDD" class="ocpSection">
  <h2 class="" id="ID0EDD">
   See Also
  </h2>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/filter-function-f4f7cb66-82eb-4767-8f7c-4877ad80c759">
    FILTER function
   </a>
  </p>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/randarray-function-21261e55-3bec-4885-86a6-8b0a47fd4d33">
    RANDARRAY function
   </a>
  </p>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/sequence-function-57467a98-57e0-4817-9f14-2eb78519ca90">
    SEQUENCE function
   </a>
  </p>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/sort-function-22f63bd0-ccc8-492f-953d-c20e8e44b86c">
    SORT function
   </a>
  </p>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/unique-function-c5ab87fd-30a3-4ce9-9d1a-40204fb85e1e">
    UNIQUE function
   </a>
  </p>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/how-to-correct-a-spill-error-ffe0f555-b479-4a17-a6e2-ef9cc9ad4023">
    #SPILL! errors in Excel
   </a>
  </p>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/dynamic-array-formulas-and-spilled-array-behavior-205c6b06-03ba-4151-89a1-87a7eb36e531">
    Dynamic arrays and spilled array behavior
   </a>
  </p>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/implicit-intersection-operator-ce3be07b-0101-4450-a24e-c1c999be2b34">
    Implicit intersection operator: @
   </a>
  </p>
 </section>
</article>
