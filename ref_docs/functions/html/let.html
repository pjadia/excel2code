<article class="ocpArticleContent">
 <section class="ocpIntroduction">
  <div class="ocpVideo" data-channel="ALTENUS_MS_OFFICE" data-llcc="en-us" data-player="SP_MOD_OfficeCom" data-videoid="RWBuAb" data-videotitle="Let Function" data-videotype="single" id="ocpVideo1">
   <universal-media-player options='{"partnerName":"SupportService","autoplay":false,"reporting":false,"language":"en-us","title":"Let Function","poster":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-e3a523aa-9687-4cd1-a6a8-d4b63e801ced/thumbnail_w800.jpeg","sources":[{"type":"MP4","quality":"HQ","src":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-e3a523aa-9687-4cd1-a6a8-d4b63e801ced/video_1001_1731975398647_1920x1080.mp4"},{"type":"MP4","quality":"HD","src":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-e3a523aa-9687-4cd1-a6a8-d4b63e801ced/video_1001_1731975398647_1280x720.mp4"},{"type":"MP4","quality":"LO","src":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-e3a523aa-9687-4cd1-a6a8-d4b63e801ced/video_1001_1731975398647_640x360.mp4"},{"type":"DASH","src":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-e3a523aa-9687-4cd1-a6a8-d4b63e801ced/video_1001_1731975398647.mpd"},{"type":"HLS","src":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-e3a523aa-9687-4cd1-a6a8-d4b63e801ced/video_1001_1731975398647_master.m3u8"}],"ccFiles":[{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-e3a523aa-9687-4cd1-a6a8-d4b63e801ced/en_us_en-us.vtt","locale":"en-us","ccType":"VTT"}]}'>
    <picture>
     <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=avif&amp;w=320 320w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=avif&amp;w=480 480w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=avif&amp;w=640 640w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=avif&amp;w=800 800w" type="image/avif"/>
     <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=webp&amp;w=320 320w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=webp&amp;w=480 480w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=webp&amp;w=640 640w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=webp&amp;w=800 800w" type="image/webp"/>
     <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=jpeg&amp;w=320 320w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=jpeg&amp;w=480 480w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=jpeg&amp;w=640 640w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
     <img alt="Your browser does not support video. Install Microsoft Silverlight, Adobe Flash Player, or Internet Explorer 9." class="fluentImage" loading="lazy" src="/images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7" style="aspect-ratio: 960/540" width="960"/>
    </picture>
   </universal-media-player>
  </div>
  <p>
   The
   <span class="ocpCodeInline">
    LET
   </span>
   function assigns names to calculation results. This allows storing intermediate calculations, values, or defining names inside a formula. These names only apply within the scope of the
   <span class="ocpCodeInline">
    LET
   </span>
   function. Similar to variables in programming,
   <span class="ocpCodeInline">
    LET
   </span>
   is accomplished through Excel's native formula syntax.
  </p>
  <p>
   To use the
   <span class="ocpCodeInline">
    LET
   </span>
   function in Excel, you define pairs of names and associated values, and a calculation that uses them all. You must define at least one name/value pair (a variable), and
   <span class="ocpCodeInline">
    LET
   </span>
   supports up to 126.
  </p>
  <p>
   <picture>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/492526a6-54ec-4c18-8800-38bec7600ff6?format=avif&amp;w=320 320w,        /images/en-us/492526a6-54ec-4c18-8800-38bec7600ff6?format=avif&amp;w=480 480w,        /images/en-us/492526a6-54ec-4c18-8800-38bec7600ff6?format=avif&amp;w=640 640w,        /images/en-us/492526a6-54ec-4c18-8800-38bec7600ff6?format=avif&amp;w=800 800w" type="image/avif"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/492526a6-54ec-4c18-8800-38bec7600ff6?format=webp&amp;w=320 320w,        /images/en-us/492526a6-54ec-4c18-8800-38bec7600ff6?format=webp&amp;w=480 480w,        /images/en-us/492526a6-54ec-4c18-8800-38bec7600ff6?format=webp&amp;w=640 640w,        /images/en-us/492526a6-54ec-4c18-8800-38bec7600ff6?format=webp&amp;w=800 800w" type="image/webp"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/492526a6-54ec-4c18-8800-38bec7600ff6?format=jpeg&amp;w=320 320w,        /images/en-us/492526a6-54ec-4c18-8800-38bec7600ff6?format=jpeg&amp;w=480 480w,        /images/en-us/492526a6-54ec-4c18-8800-38bec7600ff6?format=jpeg&amp;w=640 640w,        /images/en-us/492526a6-54ec-4c18-8800-38bec7600ff6?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
    <img alt="LET diagram" class="fluentImage" loading="lazy" src="/images/en-us/492526a6-54ec-4c18-8800-38bec7600ff6" style="aspect-ratio: 400/276" width="400"/>
   </picture>
  </p>
  <p>
   <b class="ocpLegacyBold">
    Benefits
   </b>
  </p>
  <ul>
   <li>
    <p>
     <b class="ocpLegacyBold">
      Improved Performance
     </b>
     If you write the same expression multiple times in a formula, Excel calculated that result multiple times.
     <span class="ocpCodeInline">
      LET
     </span>
     allows you to call the expression by name and for Excel to calculate it once.
    </p>
   </li>
   <li>
    <p>
     <b class="ocpLegacyBold">
      Easy Reading and Composition
     </b>
     No more having to remember what a specific range/cell reference referred to, what your calculation was doing or copy/pasting the same expression. With the ability to declare and name variables, you can give meaningful context to yourself and consumers of your formula.
    </p>
   </li>
  </ul>
 </section>
 <div class="ocpSection" data-bi-id="bmsyntax" id="bmsyntax">
  <h2 class="ocpExpandoHead">
   <button aria-controls="ID0EH-panel" aria-expanded="false" class="expandoButtonLink" id="ID0EH-button" ms.interactiontype="11" type="button">
    <div aria-hidden="true" class="ocpExpandoHeadChevronContainer">
     <i class="ms-Icon--expandoCollapsed ocpExpander" role="none">
     </i>
    </div>
    <div class="ocpExpandoHeadTitleContainer" role="none">
     Syntax
    </div>
   </button>
  </h2>
  <div aria-labelledby="ID0EH-button" class="ocpebw" id="ID0EH-panel" role="region">
   <div class="ocpExpandoBody">
    <p>
     <b class="ocpLegacyBold">
      =
      <span class="ocpCodeInline">
       LET
      </span>
      (name1, name_value1, calculation_or_name2, [name_value2, calculation_or_name3...])
     </b>
    </p>
    <table aria-label="" class="banded">
     <thead>
      <tr>
       <th>
        <p>
         Argument
        </p>
       </th>
       <th>
        <p>
         Description
        </p>
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <p>
         <b class="ocpLegacyBold">
          name1
         </b>
        </p>
        <p>
         Required
        </p>
       </td>
       <td>
        <p>
         The first name to assign. Must start with a letter. Cannot be the output of a formula or conflict with range syntax.
        </p>
       </td>
      </tr>
      <tr>
       <td>
        <p>
         <b class="ocpLegacyBold">
          name_value1
         </b>
        </p>
        <p>
         Required
        </p>
       </td>
       <td>
        <p>
         The value that is assigned to name1.
        </p>
       </td>
      </tr>
      <tr>
       <td>
        <p>
         <b class="ocpLegacyBold">
          calculation_or_name2
         </b>
        </p>
        <p>
         Required
        </p>
       </td>
       <td>
        <p>
         One of the following:
        </p>
        <ul>
         <li>
          <p>
           A calculation that uses all names within the
           <span class="ocpCodeInline">
            LET
           </span>
           function. This must be the last argument in the
           <span class="ocpCodeInline">
            LET
           </span>
           function.
          </p>
         </li>
         <li>
          <p>
           A second name to assign to a second name_value. If a name is specified, name_value2 and calculation_or_name3 become required.
          </p>
         </li>
        </ul>
       </td>
      </tr>
      <tr>
       <td>
        <p>
         <b class="ocpLegacyBold">
          name_value2
         </b>
        </p>
        <p>
         Optional
        </p>
       </td>
       <td>
        <p>
         The value that is assigned to calculation_or_name2.
        </p>
       </td>
      </tr>
      <tr>
       <td>
        <p>
         <b class="ocpLegacyBold">
          calculation_or_name3
         </b>
        </p>
        <p>
         Optional
        </p>
       </td>
       <td>
        <p>
         One of the following:
        </p>
        <ul>
         <li>
          <p>
           A calculation that uses all names within the
           <span class="ocpCodeInline">
            LET
           </span>
           function. The last argument in the
           <span class="ocpCodeInline">
            LET
           </span>
           function must be a calculation.
          </p>
         </li>
         <li>
          <p>
           A third name to assign to a third name_value. If a name is specified, name_value3 and calculation_or_name4 become required.
          </p>
         </li>
        </ul>
       </td>
      </tr>
     </tbody>
    </table>
    <div class="ocpAlert">
     <p class="ocpAlertSection">
      <b class="ocpNote">
       Notes:
      </b>
     </p>
     <ul class="ocpAlertSectionListContainer">
      <li>
       <p>
        The last argument
        <b class="ocpLegacyBold">
         must
        </b>
        be a calculation which returns a result.
       </p>
      </li>
      <li>
       <p>
        Names of variables align with valid names that can be used in the name manager. E.g. "a" is valid but "c" is not because it conflicts with R1C1 style references.
       </p>
      </li>
     </ul>
    </div>
   </div>
  </div>
 </div>
 <section aria-labelledby="ID0EFF" class="ocpSection">
  <h2 class="" id="ID0EFF">
   Examples
  </h2>
  <section aria-labelledby="ID0EDDBF" class="ocpSection">
   <h3 class="" id="ID0EDDBF">
    Example 1
   </h3>
   <p>
    Consider the simple expression "SUM(x, 1)" where x is a named variable that can be assigned a value (in this case, x is assigned the value 5).
   </p>
   <p>
    <b class="ocpLegacyBold">
     =
     <span class="ocpCodeInline">
      LET
     </span>
     (x, 5, SUM(x, 1))
    </b>
   </p>
   <p>
    When this formula is input into a cell, it will return the value 6.
   </p>
   <p>
   </p>
  </section>
  <section aria-labelledby="ID0EDBBF" class="ocpSection">
   <h3 class="" id="ID0EDBBF">
    Example 2
   </h3>
   <p>
    Suppose you have some raw sales data, and you'd like to filter that data to show one person, and add a dash to any blank cells.
   </p>
   <table aria-label="" class="banded">
    <thead>
     <tr>
      <th>
       <p>
        Unfiltered Data
       </p>
      </th>
      <th>
       <p>
        Filtered Data
       </p>
      </th>
     </tr>
    </thead>
    <tbody>
     <tr>
      <td>
       <p>
        <picture>
         <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/8b3551c8-ccd3-4348-a3f9-f0a4a8747453?format=avif&amp;w=320 320w,        /images/en-us/8b3551c8-ccd3-4348-a3f9-f0a4a8747453?format=avif&amp;w=480 480w,        /images/en-us/8b3551c8-ccd3-4348-a3f9-f0a4a8747453?format=avif&amp;w=640 640w,        /images/en-us/8b3551c8-ccd3-4348-a3f9-f0a4a8747453?format=avif&amp;w=800 800w" type="image/avif"/>
         <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/8b3551c8-ccd3-4348-a3f9-f0a4a8747453?format=webp&amp;w=320 320w,        /images/en-us/8b3551c8-ccd3-4348-a3f9-f0a4a8747453?format=webp&amp;w=480 480w,        /images/en-us/8b3551c8-ccd3-4348-a3f9-f0a4a8747453?format=webp&amp;w=640 640w,        /images/en-us/8b3551c8-ccd3-4348-a3f9-f0a4a8747453?format=webp&amp;w=800 800w" type="image/webp"/>
         <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/8b3551c8-ccd3-4348-a3f9-f0a4a8747453?format=jpeg&amp;w=320 320w,        /images/en-us/8b3551c8-ccd3-4348-a3f9-f0a4a8747453?format=jpeg&amp;w=480 480w,        /images/en-us/8b3551c8-ccd3-4348-a3f9-f0a4a8747453?format=jpeg&amp;w=640 640w,        /images/en-us/8b3551c8-ccd3-4348-a3f9-f0a4a8747453?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
         <img alt="Unfiltered Data of Sales" class="fluentImage" loading="lazy" src="/images/en-us/8b3551c8-ccd3-4348-a3f9-f0a4a8747453" style="aspect-ratio: 257/162" width="257"/>
        </picture>
       </p>
      </td>
      <td>
       <p>
        <picture>
         <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/90736422-483d-48cc-ace7-e0e2238ad21f?format=avif&amp;w=320 320w,        /images/en-us/90736422-483d-48cc-ace7-e0e2238ad21f?format=avif&amp;w=480 480w,        /images/en-us/90736422-483d-48cc-ace7-e0e2238ad21f?format=avif&amp;w=640 640w,        /images/en-us/90736422-483d-48cc-ace7-e0e2238ad21f?format=avif&amp;w=800 800w" type="image/avif"/>
         <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/90736422-483d-48cc-ace7-e0e2238ad21f?format=webp&amp;w=320 320w,        /images/en-us/90736422-483d-48cc-ace7-e0e2238ad21f?format=webp&amp;w=480 480w,        /images/en-us/90736422-483d-48cc-ace7-e0e2238ad21f?format=webp&amp;w=640 640w,        /images/en-us/90736422-483d-48cc-ace7-e0e2238ad21f?format=webp&amp;w=800 800w" type="image/webp"/>
         <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/90736422-483d-48cc-ace7-e0e2238ad21f?format=jpeg&amp;w=320 320w,        /images/en-us/90736422-483d-48cc-ace7-e0e2238ad21f?format=jpeg&amp;w=480 480w,        /images/en-us/90736422-483d-48cc-ace7-e0e2238ad21f?format=jpeg&amp;w=640 640w,        /images/en-us/90736422-483d-48cc-ace7-e0e2238ad21f?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
         <img alt="Filtered Data of Sales" class="fluentImage" loading="lazy" src="/images/en-us/90736422-483d-48cc-ace7-e0e2238ad21f" style="aspect-ratio: 369/146" width="369"/>
        </picture>
       </p>
      </td>
     </tr>
    </tbody>
   </table>
   <p>
    While the above can be done without a
    <span class="ocpCodeInline">
     LET
    </span>
    , using
    <span class="ocpCodeInline">
     LET
    </span>
    improves readability of the formula and computes twice as fast as without
    <span class="ocpCodeInline">
     LET
    </span>
    .
   </p>
   <p>
    <b class="ocpRunInHead">
     Sample data
    </b>
   </p>
   <p>
    Copy the following table to cell A1 of a blank worksheet if you'd like to walk through this example yourself.
   </p>
   <table aria-label="" class="banded">
    <tbody>
     <tr>
      <td>
       <p>
        Rep
       </p>
      </td>
      <td>
       <p>
        Region
       </p>
      </td>
      <td>
       <p>
        Product
       </p>
      </td>
      <td>
       <p>
        Profit
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        Amy
       </p>
      </td>
      <td>
       <p>
        East
       </p>
      </td>
      <td>
       <p>
        Apple
       </p>
      </td>
      <td>
       <p>
        $1.33
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        Fred
       </p>
      </td>
      <td>
       <p>
        South
       </p>
      </td>
      <td>
       <p>
        Banana
       </p>
      </td>
      <td>
       <p>
        $0.09
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        Amy
       </p>
      </td>
      <td>
       <p>
        West
       </p>
      </td>
      <td>
       <p>
        Mango
       </p>
      </td>
      <td>
       <p>
        $1.85
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        Fred
       </p>
      </td>
      <td>
       <p>
        North
       </p>
      </td>
      <td>
       <p>
       </p>
      </td>
      <td>
       <p>
        $0.82
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        Fred
       </p>
      </td>
      <td>
       <p>
        West
       </p>
      </td>
      <td>
       <p>
        Banana
       </p>
      </td>
      <td>
       <p>
        $1.25
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        Amy
       </p>
      </td>
      <td>
       <p>
        East
       </p>
      </td>
      <td>
       <p>
        Apple
       </p>
      </td>
      <td>
       <p>
        $0.72
       </p>
      </td>
     </tr>
     <tr>
      <td>
       <p>
        Fred
       </p>
      </td>
      <td>
       <p>
        North
       </p>
      </td>
      <td>
       <p>
        Mango
       </p>
      </td>
      <td>
       <p>
        $0.54
       </p>
      </td>
     </tr>
    </tbody>
   </table>
   <p>
    <b class="ocpLegacyBold">
     Original Formula
    </b>
   </p>
   <table aria-label="" class="banded">
    <tbody>
     <tr>
      <td>
       <p>
        =IF(ISBLANK(FILTER(A2:D8,A2:A8="Fred")),"-", FILTER(A2:D8,A2:A8="Fred"))
       </p>
      </td>
     </tr>
    </tbody>
   </table>
   <p>
    <b class="ocpLegacyBold">
     Formula using
     <span class="ocpCodeInline">
      LET
     </span>
    </b>
   </p>
   <table aria-label="" class="banded">
    <tbody>
     <tr>
      <td>
       <p>
        =
        <span class="ocpCodeInline">
         LET
        </span>
        (
        <b class="ocpLegacyBold">
         filterCriteria
        </b>
        ,
        <i class="ocpItalic">
         "Fred"
        </i>
        ,
        <b class="ocpLegacyBold">
         filteredRange
        </b>
        , FILTER(A2:D8,A2:A8=
        <b class="ocpLegacyBold">
         filterCriteria
        </b>
        ), IF(ISBLANK(
        <b class="ocpLegacyBold">
         filteredRange
        </b>
        ),"-",
        <b class="ocpLegacyBold">
         filteredRange
        </b>
        ))
       </p>
      </td>
     </tr>
    </tbody>
   </table>
  </section>
 </section>
 <section aria-labelledby="" class="ocpSection">
 </section>
</article>
