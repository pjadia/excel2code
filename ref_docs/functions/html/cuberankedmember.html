<article class="ocpArticleContent">
 <section class="ocpIntroduction">
  <p>
   This article describes the formula syntax and usage of the
   <b class="ocpLegacyBold">
    CUBERANKEDMEMBER
   </b>
   function in Microsoft Excel.
  </p>
 </section>
 <section aria-labelledby="ID0EFJ" class="ocpSection" data-bi-id="__goback" id="__goback">
  <h2 class="" id="ID0EFJ">
   Description
  </h2>
  <p>
   Returns the nth, or ranked, member in a set. Use to return one or more elements in a set, such as the top sales performer or the top 10 students.
  </p>
 </section>
 <section aria-labelledby="ID0EFH" class="ocpSection">
  <h2 class="" id="ID0EFH">
   Syntax
  </h2>
  <p>
   CUBERANKEDMEMBER(connection, set_expression, rank, [caption])
  </p>
  <p>
   The CUBERANKEDMEMBER function syntax has the following arguments:
  </p>
  <ul>
   <li>
    <p>
     <b class="ocpRunInHead">
      Connection
     </b>
     Required. A text string of the name of the connection to the cube.
    </p>
   </li>
   <li>
    <p>
     <b class="ocpRunInHead">
      Set_expression
     </b>
     Required. A text string of a set expression, such as "{[Item1].children}". Set_expression can also be the CUBESET function, or a reference to a cell that contains the CUBESET function.
    </p>
   </li>
   <li>
    <p>
     <b class="ocpRunInHead">
      Rank
     </b>
     Required. An integer value specifying the top value to return. If rank is a value of 1, it returns the top value, if rank is a value of 2, it returns the second most top value, and so on. To return the top 5 values, use CUBERANKEDMEMBER five times, specifying a different rank, 1 through 5, each time.
    </p>
   </li>
   <li>
    <p>
     <b class="ocpRunInHead">
      Caption
     </b>
     Optional. A text string displayed in the cell instead of the caption, if one is defined, from the cube.
    </p>
   </li>
  </ul>
 </section>
 <section aria-labelledby="ID0EFF" class="ocpSection">
  <h2 class="" id="ID0EFF">
   Remarks
  </h2>
  <ul>
   <li>
    <p>
     When the CUBERANKEDMEMBER function evaluates, it temporarily displays a "#GETTING_DATAâ€¦" message in the cell before all of the data is retrieved.
    </p>
   </li>
   <li>
    <p>
     If the connection name is not a valid workbook connection stored in the workbook, CUBERANKEDMEMBER returns a #NAME? error value. If the Online Analytical Processing (OLAP) server is not running, not available, or returns an error message, CUBERANKEDMEMBER returns a #NAME? error value.
    </p>
   </li>
   <li>
    <p>
     CUBERANKEDMEMBER returns a #N/A error value when the syntax of set_expression is incorrect or when the set contains at least one member with a different dimension than the other members.
    </p>
   </li>
  </ul>
 </section>
 <section aria-labelledby="ID0EFD" class="ocpSection">
  <h2 class="" id="ID0EFD">
   Examples
  </h2>
  <p>
   =CUBERANKEDMEMBER("Sales",$D$4,1,"Top Month")
  </p>
  <p>
   =CUBERANKEDMEMBER("Sales",CUBESET("Sales","Summer","[2004].[June]","[2004].[July]","[2004].[August]"),3,"Top Month")
  </p>
  <div class="ocpAlert">
   <p class="ocpAlertSection">
    <b class="ocpTip">
     Tip:
    </b>
    To return the bottom n values, use the sort_order and sort_by arguments of the CUBESET function to reverse the order of the set so that the top values in the sorted set are the bottom values. For example, CUBERANKEDMEMBER ("Sales", $D$4,1) returns the last member, CUBERANKEDMEMBER ("Sales", $D$4, 2) returns the next to last member, and so on.
   </p>
  </div>
 </section>
</article>
