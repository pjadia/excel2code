<article class="ocpArticleContent">
 <section class="ocpIntroduction">
  <p>
   Use the
   <b class="ocpLegacyBold">
    XLOOKUP
   </b>
   function to find things in a table or range by row. For example, look up the price of an automotive part by the part number, or find an employee name based on their employee ID. With XLOOKUP, you can look in one column for a search term and return a result from the same row in another column, regardless of which side the return column is on.
  </p>
  <div class="ocpAlert">
   <p class="ocpAlertSection">
    <b class="ocpNote">
     Note:
    </b>
    XLOOKUP is not available in Excel 2016 and Excel 2019. However, you may come across a situation of using a workbook in Excel 2016 or Excel 2019 with the XLOOKUP function in it, if it was created by someone else using a newer version of Excel.
   </p>
  </div>
  <div class="ocpVideo" data-channel="ALTENUS_MS_OFFICE" data-llcc="en-us" data-player="ocvideo" data-videoid="RE3RKR7" data-videotitle="Use the XLOOKUP function" data-videotype="single" id="ocpVideo1">
   <universal-media-player options='{"partnerName":"SupportService","autoplay":false,"reporting":false,"language":"en-us","title":"Use the XLOOKUP function","poster":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/thumbnail_w800.png","sources":[{"type":"MP4","quality":"HQ","src":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video_1001_1731968343425_1920x1080.mp4"},{"type":"MP4","quality":"HD","src":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video_1001_1731968343425_1280x720.mp4"},{"type":"MP4","quality":"LO","src":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video_1001_1731968343425_640x360.mp4"},{"type":"DASH","src":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video_1001_1731968343425.mpd"},{"type":"HLS","src":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video_1001_1731968343425_master.m3u8"}],"ccFiles":[{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/en_us_en-us.vtt","locale":"en-us","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_ar_SA_ar-sa.vtt","locale":"ar-sa","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_bg_BG_bg-bg.vtt","locale":"bg-bg","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_cs_CZ_cs-cz.vtt","locale":"cs-cz","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_da_DK_da-dk.vtt","locale":"da-dk","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_de_DE_de-de.vtt","locale":"de-de","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_el_GR_el-gr.vtt","locale":"el-gr","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_es_ES_es-es.vtt","locale":"es-es","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_et_EE_et-ee.vtt","locale":"et-ee","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_fi_FI_fi-fi.vtt","locale":"fi-fi","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_fr_FR_fr-fr.vtt","locale":"fr-fr","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_he_IL_he-il.vtt","locale":"he-il","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_hr_HR_hr-hr.vtt","locale":"hr-hr","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_hu_HU_hu-hu.vtt","locale":"hu-hu","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_id_ID_id-id.vtt","locale":"id-id","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_it_IT_it-it.vtt","locale":"it-it","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_ja_JP_ja-jp.vtt","locale":"ja-jp","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_ko_KR_ko-kr.vtt","locale":"ko-kr","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_lt_LT_lt-lt.vtt","locale":"lt-lt","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_lv_LV_lv-lv.vtt","locale":"lv-lv","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_nb_NO_nb-no.vtt","locale":"nb-no","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_nl_NL_nl-nl.vtt","locale":"nl-nl","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_pl_PL_pl-pl.vtt","locale":"pl-pl","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_pt_PT_pt-pt.vtt","locale":"pt-pt","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_pt_BR_pt-br.vtt","locale":"pt-br","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_ro_RO_ro-ro.vtt","locale":"ro-ro","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_ru_RU_ru-ru.vtt","locale":"ru-ru","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_sk_SK_sk-sk.vtt","locale":"sk-sk","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_sl_SI_sl-si.vtt","locale":"sl-si","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_sr_Latn_RS_sr-latn-rs.vtt","locale":"sr-latn-rs","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_th_TH_th-th.vtt","locale":"th-th","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_sv_SE_sv-se.vtt","locale":"sv-se","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_tr_TR_tr-tr.vtt","locale":"tr-tr","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_uk_UA_uk-ua.vtt","locale":"uk-ua","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_vi_VN_vi-vn.vtt","locale":"vi-vn","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_zh_CN_zh-cn.vtt","locale":"zh-cn","ccType":"VTT"},{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-beadd371-6b17-48ca-8cca-4e6071d7ec51/video1001_zh_TW_zh-tw.vtt","locale":"zh-tw","ccType":"VTT"}]}'>
    <picture>
     <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=avif&amp;w=320 320w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=avif&amp;w=480 480w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=avif&amp;w=640 640w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=avif&amp;w=800 800w" type="image/avif"/>
     <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=webp&amp;w=320 320w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=webp&amp;w=480 480w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=webp&amp;w=640 640w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=webp&amp;w=800 800w" type="image/webp"/>
     <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=jpeg&amp;w=320 320w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=jpeg&amp;w=480 480w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=jpeg&amp;w=640 640w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
     <img alt="Your browser does not support video. Install Microsoft Silverlight, Adobe Flash Player, or Internet Explorer 9." class="fluentImage" loading="lazy" src="/images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7" style="aspect-ratio: 960/540" width="960"/>
    </picture>
   </universal-media-player>
  </div>
 </section>
 <section aria-labelledby="ID0EDH" class="ocpSection">
  <h2 class="" id="ID0EDH">
   Syntax
  </h2>
  <p>
   The XLOOKUP function searches a range or an array, and then returns the item corresponding to the first match it finds. If no match exists, then XLOOKUP can return the closest (approximate) match.
  </p>
  <p>
   <b class="ocpLegacyBold">
    =XLOOKUP(lookup_value, lookup_array, return_array, [if_not_found], [match_mode], [search_mode])
   </b>
  </p>
  <table aria-label="" class="banded">
   <thead>
    <tr>
     <th>
      <p>
       Argument
      </p>
     </th>
     <th>
      <p>
       Description
      </p>
     </th>
    </tr>
   </thead>
   <tbody>
    <tr>
     <td>
      <p>
       <b class="ocpLegacyBold">
        lookup_value
       </b>
      </p>
      <p>
       Required*
      </p>
     </td>
     <td>
      <p>
       The value to search for
       <br aria-hidden="true"/>
       <br aria-hidden="true"/>
       *If omitted, XLOOKUP returns blank cells it finds in
       <b class="ocpUI">
        lookup_array
       </b>
       .
      </p>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       <b class="ocpLegacyBold">
        lookup_array
       </b>
      </p>
      <p>
       Required
      </p>
     </td>
     <td>
      <p>
       The array or range to search
      </p>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       <b class="ocpLegacyBold">
        return_array
       </b>
      </p>
      <p>
       Required
      </p>
     </td>
     <td>
      <p>
       The array or range to return
      </p>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       <b class="ocpLegacyBold">
        [if_not_found]
       </b>
      </p>
      <p>
       Optional
      </p>
     </td>
     <td>
      <p>
       Where a valid match is not found, return the [if_not_found] text you supply.
      </p>
      <p>
       If a valid match is not found, and [if_not_found] is missing,
       <b class="ocpLiteral">
        #N/A
       </b>
       is returned.
      </p>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       <b class="ocpLegacyBold">
        [match_mode]
       </b>
      </p>
      <p>
       Optional
      </p>
     </td>
     <td>
      <p>
       Specify the match type:
      </p>
      <p>
       0 - Exact match. If none found, return #N/A. This is the default.
      </p>
      <p>
       -1 - Exact match. If none found, return the next smaller item.
      </p>
      <p>
       1 - Exact match. If none found, return the next larger item.
      </p>
      <p>
       2 - A wildcard match where *, ?, and ~ have
       <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/using-wildcard-characters-in-searches-ef94362e-9999-4350-ad74-4d2371110adb">
        special meaning
       </a>
       .
      </p>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       <b class="ocpLegacyBold">
        [search_mode]
       </b>
      </p>
      <p>
       Optional
      </p>
     </td>
     <td>
      <p>
       Specify the search mode to use:
      </p>
      <p>
       1 - Perform a search starting at the first item. This is the default.
      </p>
      <p>
       -1 - Perform a reverse search starting at the last item.
      </p>
      <p>
       2 - Perform a binary search that relies on lookup_array being sorted in
       <i class="ocpItalic">
        ascending
       </i>
       order. If not sorted, invalid results will be returned.
      </p>
      <p>
       -2 - Perform a binary search that relies on lookup_array being sorted in
       <i class="ocpItalic">
        descending
       </i>
       order. If not sorted, invalid results will be returned.
      </p>
     </td>
    </tr>
   </tbody>
  </table>
 </section>
 <section aria-labelledby="ID0EDF" class="ocpSection">
  <h2 class="" id="ID0EDF">
   Examples
  </h2>
  <p>
   <b class="ocpRunInHead">
    Example 1
   </b>
   uses XLOOKUP to look up a country name in a range, and then return its telephone country code. It includes the
   <b class="ocpUI">
    lookup_value
   </b>
   (cell F2),
   <b class="ocpUI">
    lookup_array
   </b>
   (range B2:B11), and
   <b class="ocpUI">
    return_array
   </b>
   (range D2:D11) arguments. It doesn't include the
   <b class="ocpUI">
    match_mode
   </b>
   argument, as XLOOKUP produces an exact match by default.
  </p>
  <picture>
   <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/25529a29-8f61-4a71-92c0-f5d7b280641e?format=avif&amp;w=320 320w,        /images/en-us/25529a29-8f61-4a71-92c0-f5d7b280641e?format=avif&amp;w=480 480w,        /images/en-us/25529a29-8f61-4a71-92c0-f5d7b280641e?format=avif&amp;w=640 640w,        /images/en-us/25529a29-8f61-4a71-92c0-f5d7b280641e?format=avif&amp;w=800 800w" type="image/avif"/>
   <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/25529a29-8f61-4a71-92c0-f5d7b280641e?format=webp&amp;w=320 320w,        /images/en-us/25529a29-8f61-4a71-92c0-f5d7b280641e?format=webp&amp;w=480 480w,        /images/en-us/25529a29-8f61-4a71-92c0-f5d7b280641e?format=webp&amp;w=640 640w,        /images/en-us/25529a29-8f61-4a71-92c0-f5d7b280641e?format=webp&amp;w=800 800w" type="image/webp"/>
   <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/25529a29-8f61-4a71-92c0-f5d7b280641e?format=jpeg&amp;w=320 320w,        /images/en-us/25529a29-8f61-4a71-92c0-f5d7b280641e?format=jpeg&amp;w=480 480w,        /images/en-us/25529a29-8f61-4a71-92c0-f5d7b280641e?format=jpeg&amp;w=640 640w,        /images/en-us/25529a29-8f61-4a71-92c0-f5d7b280641e?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
   <img alt="Example of the XLOOKUP function used to return an Employee Name and Department based on Employee ID. The formula is =XLOOKUP(B2,B5:B14,C5:C14)" class="fluentImage" loading="lazy" src="/images/en-us/25529a29-8f61-4a71-92c0-f5d7b280641e" style="aspect-ratio: 425/292" width="425"/>
  </picture>
  <div class="ocpAlert">
   <p class="ocpAlertSection">
    <b class="ocpNote">
     Note:
    </b>
    XLOOKUP uses a lookup array and a return array, whereas VLOOKUP uses a single table array followed by a column index number. The equivalent VLOOKUP formula in this case would be:
    <b class="ocpLiteral">
     =VLOOKUP(F2,B2:D11,3,FALSE)
    </b>
   </p>
  </div>
  <p>
   ———————————————————————————
  </p>
  <p>
   <b class="ocpRunInHead">
    Example 2
   </b>
   looks up employee information based on an employee ID number. Unlike VLOOKUP, XLOOKUP can return an array with multiple items, so a single formula can return both employee name and department from cells C5:D14.
  </p>
  <p>
   <picture>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/9bdc7843-ee8e-4815-833f-64cff5080775?format=avif&amp;w=320 320w,        /images/en-us/9bdc7843-ee8e-4815-833f-64cff5080775?format=avif&amp;w=480 480w,        /images/en-us/9bdc7843-ee8e-4815-833f-64cff5080775?format=avif&amp;w=640 640w,        /images/en-us/9bdc7843-ee8e-4815-833f-64cff5080775?format=avif&amp;w=800 800w" type="image/avif"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/9bdc7843-ee8e-4815-833f-64cff5080775?format=webp&amp;w=320 320w,        /images/en-us/9bdc7843-ee8e-4815-833f-64cff5080775?format=webp&amp;w=480 480w,        /images/en-us/9bdc7843-ee8e-4815-833f-64cff5080775?format=webp&amp;w=640 640w,        /images/en-us/9bdc7843-ee8e-4815-833f-64cff5080775?format=webp&amp;w=800 800w" type="image/webp"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/9bdc7843-ee8e-4815-833f-64cff5080775?format=jpeg&amp;w=320 320w,        /images/en-us/9bdc7843-ee8e-4815-833f-64cff5080775?format=jpeg&amp;w=480 480w,        /images/en-us/9bdc7843-ee8e-4815-833f-64cff5080775?format=jpeg&amp;w=640 640w,        /images/en-us/9bdc7843-ee8e-4815-833f-64cff5080775?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
    <img alt="Example of the XLOOKUP function used to return an Employee Name and Department based on Employee IDt. The formula is: =XLOOKUP(B2,B5:B14,C5:D14,0,1)" class="fluentImage" loading="lazy" src="/images/en-us/9bdc7843-ee8e-4815-833f-64cff5080775" style="aspect-ratio: 435/332" width="435"/>
   </picture>
  </p>
  <p>
   ———————————————————————————
  </p>
  <p>
   <b class="ocpRunInHead">
    Example 3
   </b>
   adds an
   <b class="ocpLegacyBold">
    if_not_found
   </b>
   argument to the preceding example.
  </p>
  <p>
   <picture>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/1e91c8d7-6130-4936-a8f5-018b15403898?format=avif&amp;w=320 320w,        /images/en-us/1e91c8d7-6130-4936-a8f5-018b15403898?format=avif&amp;w=480 480w,        /images/en-us/1e91c8d7-6130-4936-a8f5-018b15403898?format=avif&amp;w=640 640w,        /images/en-us/1e91c8d7-6130-4936-a8f5-018b15403898?format=avif&amp;w=800 800w" type="image/avif"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/1e91c8d7-6130-4936-a8f5-018b15403898?format=webp&amp;w=320 320w,        /images/en-us/1e91c8d7-6130-4936-a8f5-018b15403898?format=webp&amp;w=480 480w,        /images/en-us/1e91c8d7-6130-4936-a8f5-018b15403898?format=webp&amp;w=640 640w,        /images/en-us/1e91c8d7-6130-4936-a8f5-018b15403898?format=webp&amp;w=800 800w" type="image/webp"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/1e91c8d7-6130-4936-a8f5-018b15403898?format=jpeg&amp;w=320 320w,        /images/en-us/1e91c8d7-6130-4936-a8f5-018b15403898?format=jpeg&amp;w=480 480w,        /images/en-us/1e91c8d7-6130-4936-a8f5-018b15403898?format=jpeg&amp;w=640 640w,        /images/en-us/1e91c8d7-6130-4936-a8f5-018b15403898?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
    <img alt='Example of the XLOOKUP function used to return an Employee Name and Department based on Employee ID with the if_not_found argument. The formula is =XLOOKUP(B2,B5:B14,C5:D14,0,1,"Employee not found")' class="fluentImage" loading="lazy" src="/images/en-us/1e91c8d7-6130-4936-a8f5-018b15403898" style="aspect-ratio: 435/339" width="435"/>
   </picture>
  </p>
  <p>
   ———————————————————————————
  </p>
  <p>
   <b class="ocpRunInHead">
    Example 4
   </b>
   looks in column C for the personal income entered in cell E2, and finds a matching tax rate in column B. It sets the
   <b class="ocpUI">
    if_not_found
   </b>
   argument to return
   <span class="ocpUserInput">
    0
   </span>
   (zero) if nothing is found. The
   <b class="ocpUI">
    match_mode
   </b>
   argument is set to
   <span class="ocpUserInput">
    1
   </span>
   , which means the function will look for an exact match, and if it can't find one, it returns the next larger item. Finally, the
   <b class="ocpUI">
    search_mode
   </b>
   argument is set to
   <b class="ocpLiteral">
    1
   </b>
   , which means the function will search from the first item to the last.
  </p>
  <p>
   <picture>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/d1b2c44f-adec-472f-8f68-44a58a3f4bfe?format=avif&amp;w=320 320w,        /images/en-us/d1b2c44f-adec-472f-8f68-44a58a3f4bfe?format=avif&amp;w=480 480w,        /images/en-us/d1b2c44f-adec-472f-8f68-44a58a3f4bfe?format=avif&amp;w=640 640w,        /images/en-us/d1b2c44f-adec-472f-8f68-44a58a3f4bfe?format=avif&amp;w=800 800w" type="image/avif"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/d1b2c44f-adec-472f-8f68-44a58a3f4bfe?format=webp&amp;w=320 320w,        /images/en-us/d1b2c44f-adec-472f-8f68-44a58a3f4bfe?format=webp&amp;w=480 480w,        /images/en-us/d1b2c44f-adec-472f-8f68-44a58a3f4bfe?format=webp&amp;w=640 640w,        /images/en-us/d1b2c44f-adec-472f-8f68-44a58a3f4bfe?format=webp&amp;w=800 800w" type="image/webp"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/d1b2c44f-adec-472f-8f68-44a58a3f4bfe?format=jpeg&amp;w=320 320w,        /images/en-us/d1b2c44f-adec-472f-8f68-44a58a3f4bfe?format=jpeg&amp;w=480 480w,        /images/en-us/d1b2c44f-adec-472f-8f68-44a58a3f4bfe?format=jpeg&amp;w=640 640w,        /images/en-us/d1b2c44f-adec-472f-8f68-44a58a3f4bfe?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
    <img alt="Image of the XLOOKUP function used to return a tax rate based on maximum income. This is an approximate match.The formula is: =XLOOKUP(E2,C2:C7,B2:B7,1,1)" class="fluentImage" loading="lazy" src="/images/en-us/d1b2c44f-adec-472f-8f68-44a58a3f4bfe" style="aspect-ratio: 435/227" width="435"/>
   </picture>
  </p>
  <div class="ocpAlert">
   <p class="ocpAlertSection">
    <b class="ocpNote">
     Note:
    </b>
    XARRAY's
    <b class="ocpUI">
     lookup_array
    </b>
    column is to the right of the
    <b class="ocpUI">
     return_array
    </b>
    column, whereas VLOOKUP can only look from left-to-right.
   </p>
  </div>
  <p>
   ———————————————————————————
  </p>
  <p>
   <b class="ocpRunInHead">
    Example 5
   </b>
   uses a nested XLOOKUP function to perform both a vertical and horizontal match. It first looks for
   <b class="ocpLegacyBold">
    Gross Profit
   </b>
   in column B, then looks for
   <b class="ocpLegacyBold">
    Qtr1
   </b>
   in the top row of the table (range C5:F5), and finally returns the value at the intersection of the two. This is similar to using the
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/index-function-a5dcf0dd-996d-40a4-a822-b56b061328bd">
    INDEX
   </a>
   and
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/match-function-e8dffd45-c762-47d6-bf89-533f4a37673a">
    MATCH
   </a>
   functions together.
  </p>
  <div class="ocpAlert">
   <p class="ocpAlertSection">
    <b class="ocpTip">
     Tip:
    </b>
    You can also use XLOOKUP to replace the
    <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/hlookup-function-a3034eec-b719-4ba3-bb65-e1ad662ed95f">
     HLOOKUP
    </a>
    function.
   </p>
  </div>
  <p>
   <picture>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/466ac8dc-31ff-4f50-8a79-6fcb9c9dc539?format=avif&amp;w=320 320w,        /images/en-us/466ac8dc-31ff-4f50-8a79-6fcb9c9dc539?format=avif&amp;w=480 480w,        /images/en-us/466ac8dc-31ff-4f50-8a79-6fcb9c9dc539?format=avif&amp;w=640 640w,        /images/en-us/466ac8dc-31ff-4f50-8a79-6fcb9c9dc539?format=avif&amp;w=800 800w" type="image/avif"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/466ac8dc-31ff-4f50-8a79-6fcb9c9dc539?format=webp&amp;w=320 320w,        /images/en-us/466ac8dc-31ff-4f50-8a79-6fcb9c9dc539?format=webp&amp;w=480 480w,        /images/en-us/466ac8dc-31ff-4f50-8a79-6fcb9c9dc539?format=webp&amp;w=640 640w,        /images/en-us/466ac8dc-31ff-4f50-8a79-6fcb9c9dc539?format=webp&amp;w=800 800w" type="image/webp"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/466ac8dc-31ff-4f50-8a79-6fcb9c9dc539?format=jpeg&amp;w=320 320w,        /images/en-us/466ac8dc-31ff-4f50-8a79-6fcb9c9dc539?format=jpeg&amp;w=480 480w,        /images/en-us/466ac8dc-31ff-4f50-8a79-6fcb9c9dc539?format=jpeg&amp;w=640 640w,        /images/en-us/466ac8dc-31ff-4f50-8a79-6fcb9c9dc539?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
    <img alt="Image of the XLOOKUP function used to return horizontal data from a table by nesting 2 XLOOKUPs. The formula is: =XLOOKUP(D2,$B6:$B17,XLOOKUP($C3,$C5:$G5,$C6:$G17))" class="fluentImage" loading="lazy" src="/images/en-us/466ac8dc-31ff-4f50-8a79-6fcb9c9dc539" style="aspect-ratio: 435/309" width="435"/>
   </picture>
  </p>
  <div class="ocpAlert">
   <p class="ocpAlertSection">
    <b class="ocpNote">
     Note:
    </b>
    The formula in cells D3:F3 is:
    <b class="ocpLiteral">
     =XLOOKUP(D2,$B6:$B17,XLOOKUP($C3,$C5:$G5,$C6:$G17))
    </b>
    .
   </p>
  </div>
  <p>
   ———————————————————————————
  </p>
  <p>
   <b class="ocpRunInHead">
    Example 6
   </b>
   uses the
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/sum-function-043e1c7d-7726-4e80-8f32-07b23e057f89">
    SUM function
   </a>
   , and two nested XLOOKUP functions, to sum all the values between two ranges. In this case, we want to sum the values for grapes, bananas, and include pears, which are between the two.
  </p>
  <p>
   <picture>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/c05e2d7d-e0dd-49a5-801c-7a5a838ce53e?format=avif&amp;w=320 320w,        /images/en-us/c05e2d7d-e0dd-49a5-801c-7a5a838ce53e?format=avif&amp;w=480 480w,        /images/en-us/c05e2d7d-e0dd-49a5-801c-7a5a838ce53e?format=avif&amp;w=640 640w,        /images/en-us/c05e2d7d-e0dd-49a5-801c-7a5a838ce53e?format=avif&amp;w=800 800w" type="image/avif"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/c05e2d7d-e0dd-49a5-801c-7a5a838ce53e?format=webp&amp;w=320 320w,        /images/en-us/c05e2d7d-e0dd-49a5-801c-7a5a838ce53e?format=webp&amp;w=480 480w,        /images/en-us/c05e2d7d-e0dd-49a5-801c-7a5a838ce53e?format=webp&amp;w=640 640w,        /images/en-us/c05e2d7d-e0dd-49a5-801c-7a5a838ce53e?format=webp&amp;w=800 800w" type="image/webp"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/c05e2d7d-e0dd-49a5-801c-7a5a838ce53e?format=jpeg&amp;w=320 320w,        /images/en-us/c05e2d7d-e0dd-49a5-801c-7a5a838ce53e?format=jpeg&amp;w=480 480w,        /images/en-us/c05e2d7d-e0dd-49a5-801c-7a5a838ce53e?format=jpeg&amp;w=640 640w,        /images/en-us/c05e2d7d-e0dd-49a5-801c-7a5a838ce53e?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
    <img alt="Using XLOOKUP with SUM to total a range of values that fall between two selections" class="fluentImage" loading="lazy" src="/images/en-us/c05e2d7d-e0dd-49a5-801c-7a5a838ce53e" style="aspect-ratio: 435/228" width="435"/>
   </picture>
  </p>
  <p>
   The formula in cell E3 is:
   <span class="ocpUserInput">
    =SUM(XLOOKUP(B3,B6:B10,E6:E10):XLOOKUP(C3,B6:B10,E6:E10))
   </span>
  </p>
  <p>
   How does it work? XLOOKUP returns a range, so when it calculates, the formula ends up looking like this:
   <span class="ocpUserInput">
    =SUM($E$7:$E$9)
   </span>
   . You can see how this works on your own by selecting a cell with an XLOOKUP formula similar to this one, then select
   <b class="ocpUI">
    Formulas
   </b>
   &gt;
   <b class="ocpUI">
    Formula Auditing
   </b>
   &gt;
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/evaluate-a-nested-formula-one-step-at-a-time-59a201ae-d1dc-4b15-8586-a70aa409b8a7">
    Evaluate Formula
   </a>
   , and then select
   <b class="ocpUI">
    Evaluate
   </b>
   to step through the calculation.
  </p>
  <div class="ocpAlert">
   <p class="ocpAlertSection">
    <b class="ocpNote">
     Note:
    </b>
    Thanks to Microsoft Excel MVP,
    <a class="ocpExternalLink" data-bi-type="anchor" href="https://mvp.microsoft.com/en-us/PublicProfile/21505?fullName=Bill%20Jelen" target="_blank">
     Bill Jelen
    </a>
    , for suggesting this example.
   </p>
  </div>
  <p>
   ———————————————————————————
  </p>
 </section>
 <section aria-labelledby="ID0EDD" class="ocpSection">
  <h2 class="" id="ID0EDD">
   See also
  </h2>
  <p>
   You can always ask an expert in the
   <a class="ocpExternalLink" data-bi-type="anchor" href="https://techcommunity.microsoft.com/t5/Excel/ct-p/Excel_Cat" target="_blank">
    Excel Tech Community
   </a>
   or get support in
   <a class="ocpExternalLink" data-bi-type="anchor" href="https://answers.microsoft.com/lang/msoffice/forum/msoffice_excel" target="_blank">
    Communities
   </a>
   .
  </p>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/xmatch-function-d966da31-7a6b-4a13-a1c6-5a33ed6a0312">
    XMATCH function
   </a>
  </p>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/excel-functions-alphabetical-b3944572-255d-4efb-bb96-c6d90033e188">
    Excel functions (alphabetical)
   </a>
  </p>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/excel-functions-by-category-5f91f4e9-7b42-46d2-9bd1-63f26a86c0eb">
    Excel functions (by category)
   </a>
  </p>
 </section>
</article>
