<article class="ocpArticleContent">
 <section class="ocpIntroduction">
  <p>
   The
   <b class="ocpLegacyBold">
    XMATCH
   </b>
   function searches for a specified item in an array or range of cells, and then returns the item's relative position.
  </p>
  <p>
   Assume we have a list of products in cells C3 through C7 and we wish to determine where in the list the product from cell E3 is located. Here, we'll use XMATCH to determine an item's position within a list.
  </p>
  <p>
   <picture>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/d3623035-bb05-442f-bcc7-6c1b32559b63?format=avif&amp;w=320 320w,        /images/en-us/d3623035-bb05-442f-bcc7-6c1b32559b63?format=avif&amp;w=480 480w,        /images/en-us/d3623035-bb05-442f-bcc7-6c1b32559b63?format=avif&amp;w=640 640w,        /images/en-us/d3623035-bb05-442f-bcc7-6c1b32559b63?format=avif&amp;w=800 800w" type="image/avif"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/d3623035-bb05-442f-bcc7-6c1b32559b63?format=webp&amp;w=320 320w,        /images/en-us/d3623035-bb05-442f-bcc7-6c1b32559b63?format=webp&amp;w=480 480w,        /images/en-us/d3623035-bb05-442f-bcc7-6c1b32559b63?format=webp&amp;w=640 640w,        /images/en-us/d3623035-bb05-442f-bcc7-6c1b32559b63?format=webp&amp;w=800 800w" type="image/webp"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/d3623035-bb05-442f-bcc7-6c1b32559b63?format=jpeg&amp;w=320 320w,        /images/en-us/d3623035-bb05-442f-bcc7-6c1b32559b63?format=jpeg&amp;w=480 480w,        /images/en-us/d3623035-bb05-442f-bcc7-6c1b32559b63?format=jpeg&amp;w=640 640w,        /images/en-us/d3623035-bb05-442f-bcc7-6c1b32559b63?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
    <img alt="Example of using XMATCH to find the position of an item in a list" class="fluentImage" loading="lazy" src="/images/en-us/d3623035-bb05-442f-bcc7-6c1b32559b63" style="aspect-ratio: 398/220" width="398"/>
   </picture>
  </p>
 </section>
 <section aria-labelledby="ID0EDJ" class="ocpSection">
  <h2 class="" id="ID0EDJ">
   Syntax
  </h2>
  <p>
   The XMATCH function returns the relative position of an item in an array or range of cells.
  </p>
  <p>
   <b class="ocpLegacyBold">
    =XMATCH(lookup_value, lookup_array, [match_mode], [search_mode])
   </b>
  </p>
  <table aria-label="" class="banded">
   <thead>
    <tr>
     <th>
      <p>
       <b class="ocpLegacyBold">
        Argument
       </b>
      </p>
     </th>
     <th>
      <p>
       <b class="ocpLegacyBold">
        Description
       </b>
      </p>
     </th>
    </tr>
   </thead>
   <tbody>
    <tr>
     <td>
      <p>
       <b class="ocpLegacyBold">
        lookup_value
       </b>
      </p>
      <p>
       Required
      </p>
     </td>
     <td>
      <p>
       The lookup value
      </p>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       <b class="ocpLegacyBold">
        lookup_array
       </b>
      </p>
      <p>
       Required
      </p>
     </td>
     <td>
      <p>
       The array or range to search
      </p>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       <b class="ocpLegacyBold">
        [match_mode]
       </b>
      </p>
      <p>
       Optional
      </p>
     </td>
     <td>
      <p>
       Specify the match type:
      </p>
      <p>
       0 - Exact match (default)
      </p>
      <p>
       -1 - Exact match or next smallest item
      </p>
      <p>
       1 - Exact match or next largest item
      </p>
      <p>
       2 - A wildcard match where *, ?, and ~ have
       <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/using-wildcard-characters-in-searches-ef94362e-9999-4350-ad74-4d2371110adb">
        special meaning
       </a>
       .
      </p>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       <b class="ocpLegacyBold">
        [search_mode]
       </b>
      </p>
      <p>
       Optional
      </p>
     </td>
     <td>
      <p>
       Specify the search type:
      </p>
      <p>
       1 - Search first-to-last (default)
      </p>
      <p>
       -1 - Search last-to-first (reverse search).
      </p>
      <p>
       2 - Perform a binary search that relies on lookup_array being sorted in
       <i class="ocpItalic">
        ascending
       </i>
       order. If not sorted, invalid results will be returned.
      </p>
      <p>
       -2 - Perform a binary search that relies on lookup_array being sorted in
       <i class="ocpItalic">
        descending
       </i>
       order. If not sorted, invalid results will be returned.
      </p>
     </td>
    </tr>
   </tbody>
  </table>
 </section>
 <section aria-labelledby="ID0EFH" class="ocpSection">
  <h2 class="" id="ID0EFH">
   Examples
  </h2>
  <section aria-labelledby="ID0EDHBH" class="ocpSection">
   <h3 class="" id="ID0EDHBH">
    Example 1
   </h3>
   <p>
    The exact position of the first phrase that exactly matches or comes closest to the value of "Gra" is determined in the example that follow.
   </p>
   <p>
    Formula:
    <b class="ocpLegacyBold">
     XMATCH(E3,C3:C7,1)
    </b>
   </p>
   <p>
    <picture>
     <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/ae41a3a1-0bdb-407c-99a0-1ccbb727ad0c?format=avif&amp;w=320 320w,        /images/en-us/ae41a3a1-0bdb-407c-99a0-1ccbb727ad0c?format=avif&amp;w=480 480w,        /images/en-us/ae41a3a1-0bdb-407c-99a0-1ccbb727ad0c?format=avif&amp;w=640 640w,        /images/en-us/ae41a3a1-0bdb-407c-99a0-1ccbb727ad0c?format=avif&amp;w=800 800w" type="image/avif"/>
     <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/ae41a3a1-0bdb-407c-99a0-1ccbb727ad0c?format=webp&amp;w=320 320w,        /images/en-us/ae41a3a1-0bdb-407c-99a0-1ccbb727ad0c?format=webp&amp;w=480 480w,        /images/en-us/ae41a3a1-0bdb-407c-99a0-1ccbb727ad0c?format=webp&amp;w=640 640w,        /images/en-us/ae41a3a1-0bdb-407c-99a0-1ccbb727ad0c?format=webp&amp;w=800 800w" type="image/webp"/>
     <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/ae41a3a1-0bdb-407c-99a0-1ccbb727ad0c?format=jpeg&amp;w=320 320w,        /images/en-us/ae41a3a1-0bdb-407c-99a0-1ccbb727ad0c?format=jpeg&amp;w=480 480w,        /images/en-us/ae41a3a1-0bdb-407c-99a0-1ccbb727ad0c?format=jpeg&amp;w=640 640w,        /images/en-us/ae41a3a1-0bdb-407c-99a0-1ccbb727ad0c?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
     <img alt='An Excel table listing different fruit products from cell C3 to C7. The XMATCH formula is used to find the position in the table where the text matches "gra" (defined in cell E3). The formula returns "2" as the text "Grape" is in position two in the table.' class="fluentImage" loading="lazy" src="/images/en-us/ae41a3a1-0bdb-407c-99a0-1ccbb727ad0c" style="aspect-ratio: 403/215" width="403"/>
    </picture>
   </p>
  </section>
  <section aria-labelledby="ID0EDFBH" class="ocpSection">
   <h3 class="" id="ID0EDFBH">
    Example 2
   </h3>
   <p>
    The number of salespeople qualified for a bonus is determined in the following example. In order to discover the closest item in the list or an exact match, this also uses 1 for the match_mode; however, because the data is numeric, it returns a count of values. Since there were four sales representatives that exceeded the bonus amount in this instance, the function yields 4.
   </p>
   <p>
    Formula=
    <b class="ocpLegacyBold">
     XMATCH(F2,C3:C9,1)
    </b>
   </p>
   <p>
    <picture>
     <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/975f0119-7a49-4d9f-b0df-d6e37ef7beb1?format=avif&amp;w=320 320w,        /images/en-us/975f0119-7a49-4d9f-b0df-d6e37ef7beb1?format=avif&amp;w=480 480w,        /images/en-us/975f0119-7a49-4d9f-b0df-d6e37ef7beb1?format=avif&amp;w=640 640w,        /images/en-us/975f0119-7a49-4d9f-b0df-d6e37ef7beb1?format=avif&amp;w=800 800w" type="image/avif"/>
     <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/975f0119-7a49-4d9f-b0df-d6e37ef7beb1?format=webp&amp;w=320 320w,        /images/en-us/975f0119-7a49-4d9f-b0df-d6e37ef7beb1?format=webp&amp;w=480 480w,        /images/en-us/975f0119-7a49-4d9f-b0df-d6e37ef7beb1?format=webp&amp;w=640 640w,        /images/en-us/975f0119-7a49-4d9f-b0df-d6e37ef7beb1?format=webp&amp;w=800 800w" type="image/webp"/>
     <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/975f0119-7a49-4d9f-b0df-d6e37ef7beb1?format=jpeg&amp;w=320 320w,        /images/en-us/975f0119-7a49-4d9f-b0df-d6e37ef7beb1?format=jpeg&amp;w=480 480w,        /images/en-us/975f0119-7a49-4d9f-b0df-d6e37ef7beb1?format=jpeg&amp;w=640 640w,        /images/en-us/975f0119-7a49-4d9f-b0df-d6e37ef7beb1?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
     <img alt="An Excel table that lists Sales Representatives names in cells B3 to B9, and the total sales value for each representative in cells C3 through C9. The XMATCH formula is used to return the number of sales representatives eligible for bonuses if they meet the threshold amount set in cell F2." class="fluentImage" loading="lazy" src="/images/en-us/975f0119-7a49-4d9f-b0df-d6e37ef7beb1" style="aspect-ratio: 431/255" width="431"/>
    </picture>
   </p>
  </section>
  <section aria-labelledby="ID0EDDBH" class="ocpSection">
   <h3 class="" id="ID0EDDBH">
    Example 3
   </h3>
   <p>
    Next, we'll perform a simultaneous vertical and horizontal lookup using a mix of INDEX/XMATCH/XMATCH. In this instance, we would want the sales total for a certain sales representative and month to be returned. This is comparable to combining
    <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/index-function-a5dcf0dd-996d-40a4-a822-b56b061328bd">
     INDEX
    </a>
    and
    <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/match-function-e8dffd45-c762-47d6-bf89-533f4a37673a">
     MATCH
    </a>
    methods, but it takes less arguments.
   </p>
   <p>
    Formula=
    <b class="ocpLegacyBold">
     INDEX(C6:E12,XMATCH(B3,B6:B12),XMATCH(C3,C5:E5))
    </b>
   </p>
   <p>
    <picture>
     <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/ed42b884-5109-4756-a8e5-5aa8031e4918?format=avif&amp;w=320 320w,        /images/en-us/ed42b884-5109-4756-a8e5-5aa8031e4918?format=avif&amp;w=480 480w,        /images/en-us/ed42b884-5109-4756-a8e5-5aa8031e4918?format=avif&amp;w=640 640w,        /images/en-us/ed42b884-5109-4756-a8e5-5aa8031e4918?format=avif&amp;w=800 800w" type="image/avif"/>
     <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/ed42b884-5109-4756-a8e5-5aa8031e4918?format=webp&amp;w=320 320w,        /images/en-us/ed42b884-5109-4756-a8e5-5aa8031e4918?format=webp&amp;w=480 480w,        /images/en-us/ed42b884-5109-4756-a8e5-5aa8031e4918?format=webp&amp;w=640 640w,        /images/en-us/ed42b884-5109-4756-a8e5-5aa8031e4918?format=webp&amp;w=800 800w" type="image/webp"/>
     <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/ed42b884-5109-4756-a8e5-5aa8031e4918?format=jpeg&amp;w=320 320w,        /images/en-us/ed42b884-5109-4756-a8e5-5aa8031e4918?format=jpeg&amp;w=480 480w,        /images/en-us/ed42b884-5109-4756-a8e5-5aa8031e4918?format=jpeg&amp;w=640 640w,        /images/en-us/ed42b884-5109-4756-a8e5-5aa8031e4918?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
     <img alt="An Excel table where sales representative names are listed in cells B6 through B12, and sales amounts for each representative from the months of January through March are listed in columns C, D and E. The formula combination of INDEX and XMATCH is used to return the sales amount of a specific sales representative and month listed in cells B3 and C3." class="fluentImage" loading="lazy" src="/images/en-us/ed42b884-5109-4756-a8e5-5aa8031e4918" style="aspect-ratio: 432/286" width="432"/>
    </picture>
   </p>
  </section>
  <section aria-labelledby="ID0EDBBH" class="ocpSection">
   <h3 class="" id="ID0EDBBH">
    Example 4
   </h3>
   <p>
    In addition, XMATCH can be used to return a value within an array. =XMATCH(4,{5,4,3,2,1}), for instance, would provide 2 because 4 is the array's second entry. While =XMATCH(4.5,{5,4,3,2,1},1) produces 1 in this exact match case, the match_mode argument (1) is configured to return either an exact match or the next largest item, which is 5.
   </p>
  </section>
 </section>
 <section aria-labelledby="ID0EDF" class="ocpSection">
  <h2 class="" id="ID0EDF">
   Need more help?
  </h2>
  <p>
   You can always ask an expert in the
   <a class="ocpExternalLink" data-bi-type="anchor" href="https://techcommunity.microsoft.com/t5/Excel/ct-p/Excel_Cat" target="_blank">
    Excel Tech Community
   </a>
   or get support in
   <a class="ocpExternalLink" data-bi-type="anchor" href="https://answers.microsoft.com/lang/msoffice/forum/msoffice_excel" target="_blank">
    Communities
   </a>
   .
  </p>
  <p>
  </p>
 </section>
 <section aria-labelledby="ID0EDD" class="ocpSection">
  <h2 class="" id="ID0EDD">
   See also
  </h2>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/xlookup-function-b7fd680e-6d10-43e6-84f9-88eae8bf5929">
    XLOOKUP function
   </a>
  </p>
 </section>
</article>
