<article class="ocpArticleContent">
 <section class="ocpIntroduction">
  <p>
   This article describes the formula syntax and usage of the
   <b class="ocpLegacyBold">
    RANK.EQ
   </b>
   function in Microsoft Excel.
  </p>
 </section>
 <section aria-labelledby="ID0EDJ" class="ocpSection">
  <h2 class="" id="ID0EDJ">
   Description
  </h2>
  <p>
   Returns the rank of a number in a list of numbers. Its size is relative to other values in the list; if more than one value has the same rank, the top rank of that set of values is returned.
  </p>
  <p>
   If you were to sort the list, the rank of the number would be its position.
  </p>
 </section>
 <section aria-labelledby="ID0EDH" class="ocpSection">
  <h2 class="" id="ID0EDH">
   Syntax
  </h2>
  <p>
   RANK.EQ(number,ref,[order])
  </p>
  <p>
   The RANK.EQ function syntax has the following arguments:
  </p>
  <ul>
   <li>
    <p>
     <b class="ocpRunInHead">
      Number
     </b>
     Required. The number whose rank you want to find.
    </p>
   </li>
   <li>
    <p>
     <b class="ocpRunInHead">
      Ref
     </b>
     Required. An array of, or a reference to, a list of numbers. Non-numeric values in Ref are ignored.
    </p>
   </li>
   <li>
    <p>
     <b class="ocpRunInHead">
      Order
     </b>
     Optional. A number specifying how to rank number.
    </p>
   </li>
  </ul>
 </section>
 <section aria-labelledby="ID0EDF" class="ocpSection">
  <h2 class="" id="ID0EDF">
   Remarks
  </h2>
  <ul>
   <li>
    <p>
     If Order is 0 (zero) or omitted, Excel ranks Number as if Ref were a list sorted in descending order.
    </p>
   </li>
   <li>
    <p>
     If Order is any nonzero value, Excel ranks Number as if Ref were a list sorted in ascending order.
    </p>
   </li>
   <li>
    <p>
     RANK.EQ gives duplicate numbers the same rank. However, the presence of duplicate numbers affects the ranks of subsequent numbers. For example, in a list of integers sorted in ascending order, if the number 10 appears twice and has a rank of 5, then 11 would have a rank of 7 (no number would have a rank of 6).
    </p>
   </li>
   <li>
    <p>
     For some purposes one might want to use a definition of rank that takes ties into account. In the previous example, you would want a revised rank of 5.5 for the number 10. This can be done by adding the following correction factor to the value returned by RANK.EQ. This correction factor is appropriate both for the case where rank is computed in descending order (order = 0 or omitted) or ascending order (order = nonzero value).
    </p>
    <p>
     Correction factor for tied ranks=[COUNT(ref) + 1 – RANK.EQ(number, ref, 0) – RANK.EQ(number, ref, 1)]/2.
    </p>
    <p>
     In the example in the workbook, RANK.EQ(A3,A2:A6,1) equals 3. The correction factor is (5 + 1 – 2 – 3)/2 = 0.5 and the revised rank that takes ties into account is 3 + 0.5 = 3.5. If number occurs only once in ref, the correction factor will be 0, since RANK.EQ would not have to be adjusted for a tie.
    </p>
   </li>
  </ul>
 </section>
 <section aria-labelledby="ID0EDD" class="ocpSection">
  <h2 class="" id="ID0EDD">
   Example
  </h2>
  <p>
   Copy the example data in the following table, and paste it in cell A1 of a new Excel worksheet. For formulas to show results, select them, press F2, and then press Enter. If you need to, you can adjust the column widths to see all the data.
  </p>
  <table aria-label="" class="banded">
   <thead>
    <tr>
     <th>
      <p>
       <b class="ocpLegacyBold">
        Data
       </b>
      </p>
     </th>
     <th>
     </th>
     <th>
     </th>
    </tr>
   </thead>
   <tbody>
    <tr>
     <td>
      <p>
       7
      </p>
     </td>
     <td>
     </td>
     <td>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       3.5
      </p>
     </td>
     <td>
     </td>
     <td>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       3.5
      </p>
     </td>
     <td>
     </td>
     <td>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       1
      </p>
     </td>
     <td>
     </td>
     <td>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       2
      </p>
     </td>
     <td>
     </td>
     <td>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       <b class="ocpLegacyBold">
        Formula
       </b>
      </p>
     </td>
     <td>
      <p>
       <b class="ocpLegacyBold">
        Description
       </b>
      </p>
     </td>
     <td>
      <p>
       <b class="ocpLegacyBold">
        Result
       </b>
      </p>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       =RANK.EQ(A2,A2:A6,1)
      </p>
     </td>
     <td>
      <p>
       Rank of 7 in the list contained in the range A2:A6. Because the Order argument (1) is a non-zero value, the list is sorted lowest to highest.
      </p>
     </td>
     <td>
      <p>
       5
      </p>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       =RANK.EQ(A6,A2:A6)
      </p>
     </td>
     <td>
      <p>
       Rank of 2 in the same list. Because the Order argument is omitted, the list is sorted, by default, highest to lowest.
      </p>
     </td>
     <td>
      <p>
       4
      </p>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       =RANK.EQ(A3,A2:A6,1)
      </p>
     </td>
     <td>
      <p>
       Rank of 3.5 in the same list.
      </p>
     </td>
     <td>
      <p>
       3
      </p>
     </td>
    </tr>
   </tbody>
  </table>
 </section>
</article>
