<article class="ocpArticleContent">
 <section class="ocpIntroduction">
  <p>
   The FILTERXML function returns specific data from XML content by using the specified xpath.
  </p>
  <div class="ocpAlert">
   <p class="ocpAlertSection">
    <b class="ocpNote">
     Notes:
    </b>
   </p>
   <ul class="ocpAlertSectionListContainer">
    <li>
     <p>
      The FILTERXML function is not available in Excel for the web and Excel for Mac.
     </p>
    </li>
    <li>
     <p>
      This function may appear in the function gallery in Excel for Mac, but it relies on features of the Windows operating system, so it will not return results on Mac.
     </p>
    </li>
   </ul>
  </div>
 </section>
 <section aria-labelledby="ID0EDJ" class="ocpSection">
  <h2 class="" id="ID0EDJ">
   Syntax
  </h2>
  <p>
   <b class="ocpLegacyBold">
    FILTERXML(xml, xpath)
   </b>
  </p>
  <p>
   The FILTERXML function syntax has the following arguments.
  </p>
  <table aria-label="" class="banded">
   <thead>
    <tr>
     <th>
      <p>
       <b class="ocpLegacyBold">
        Argument
       </b>
      </p>
     </th>
     <th>
      <p>
       <b class="ocpLegacyBold">
        Description
       </b>
      </p>
     </th>
    </tr>
   </thead>
   <tbody>
    <tr>
     <td>
      <p>
       <b class="ocpRunInHead">
        xml
       </b>
      </p>
      <p>
       Required
      </p>
     </td>
     <td>
      <p>
       A string in valid XML format
      </p>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       <b class="ocpRunInHead">
        xpath
       </b>
      </p>
      <p>
       Required
      </p>
     </td>
     <td>
      <p>
       A string in standard XPath format
      </p>
     </td>
    </tr>
   </tbody>
  </table>
  <div class="ocpAlert">
   <p class="ocpAlertSection">
    <b class="ocpNote">
     Notes:
    </b>
   </p>
   <ul class="ocpAlertSectionListContainer">
    <li>
     <p>
      If xml is not valid, FILTERXML returns the #VALUE! error value.
     </p>
    </li>
    <li>
     <p>
      If xml contains a namespace with a prefix that is not valid, FILTERXML returns the #VALUE! error value.
     </p>
    </li>
   </ul>
  </div>
 </section>
 <section aria-labelledby="ID0EDH" class="ocpSection">
  <h2 class="" id="ID0EDH">
   Examples
  </h2>
  <ol type="1">
   <li>
    <p>
     This example uses the FILTERXML function on XML data returned in cell B2, which is provided by the results of the WEBSERVICE function on the web query in cell B1.
    </p>
    <p>
     <picture>
      <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/5e8e7a83-8439-4537-b393-e1e536df98df?format=avif&amp;w=320 320w,        /images/en-us/5e8e7a83-8439-4537-b393-e1e536df98df?format=avif&amp;w=480 480w,        /images/en-us/5e8e7a83-8439-4537-b393-e1e536df98df?format=avif&amp;w=640 640w,        /images/en-us/5e8e7a83-8439-4537-b393-e1e536df98df?format=avif&amp;w=800 800w" type="image/avif"/>
      <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/5e8e7a83-8439-4537-b393-e1e536df98df?format=webp&amp;w=320 320w,        /images/en-us/5e8e7a83-8439-4537-b393-e1e536df98df?format=webp&amp;w=480 480w,        /images/en-us/5e8e7a83-8439-4537-b393-e1e536df98df?format=webp&amp;w=640 640w,        /images/en-us/5e8e7a83-8439-4537-b393-e1e536df98df?format=webp&amp;w=800 800w" type="image/webp"/>
      <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/5e8e7a83-8439-4537-b393-e1e536df98df?format=jpeg&amp;w=320 320w,        /images/en-us/5e8e7a83-8439-4537-b393-e1e536df98df?format=jpeg&amp;w=480 480w,        /images/en-us/5e8e7a83-8439-4537-b393-e1e536df98df?format=jpeg&amp;w=640 640w,        /images/en-us/5e8e7a83-8439-4537-b393-e1e536df98df?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
      <img alt="An example of the FILTERXML function" class="fluentImage" loading="lazy" src="/images/en-us/5e8e7a83-8439-4537-b393-e1e536df98df" style="aspect-ratio: 520/148" width="520"/>
     </picture>
    </p>
    <p>
     The data from FILTERXML is returned in cells B3:B5 and C3:C5, and shows the three most recently updated query results on Wikipedia and the time of their updates (in UTC, "Coordinated Universal Time").
    </p>
    <p>
     Cells B3:B5 contain the formula =FILTERXML(B3,"//rc/@title").
    </p>
    <p>
     Cells C3:C5 contain the formula =FILTERXML(B3,"//rc/@timestamp").
    </p>
    <div class="ocpAlert">
     <p class="ocpAlertSection">
      <b class="ocpNote">
       Note:
      </b>
      If you have a current version of
      <a class="ocpExternalLink" data-bi-type="anchor" href="https://products.office.com/en-us/buy/compare-microsoft-office-products" target="_blank">
       Microsoft 365
      </a>
      , then you can simply enter the formula in the top-left-cell of the output range, then press
      <b class="ocpUI">
       ENTER
      </b>
      to confirm the formula as a dynamic array formula. Otherwise, the formula must be entered as a legacy array formula by first selecting the output range, entering the formula in the top-left-cell of the output range, and then pressing
      <b class="ocpUI">
       CTRL+SHIFT+ENTER
      </b>
      to confirm it. Excel inserts curly brackets at the beginning and end of the formula for you. For more information on array formulas, see
      <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/guidelines-and-examples-of-array-formulas-7d94a64e-3ff3-4686-9372-ecfd5caa57c7">
       Guidelines and examples of array formulas
      </a>
      .
     </p>
    </div>
   </li>
   <li>
    <p>
     You can also use FILTERXML in conjunction with the
     <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/encodeurl-function-07c7fb90-7c60-4bff-8687-fac50fe33d0e">
      ENCODEURL
     </a>
     and
     <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/webservice-function-0546a35a-ecc6-4739-aed7-c0b7ce1562c4">
      WEBSERVICE
     </a>
     functions. For example, you can use the markitondemand.com api service to return information about a company stock:
    </p>
    <p>
     <b class="ocpLegacyBold">
      =WEBSERVICE("http://dev.markitondemand.com/MODApis/Api/Quote/xml?symbol="&amp;ENCODEURL(C2))
     </b>
    </p>
    <p>
     Where you have a stock ticker in cell C2.
    </p>
    <p>
     You can then use the FILTERXML function to extract specific data about that stock. For example, to get the Last Price of the stock ticker in cell C2, you can use:
    </p>
    <p>
     <b class="ocpLegacyBold">
      =FILTERXML(WEBSERVICE("http://dev.markitondemand.com/MODApis/Api/Quote/xml?symbol="&amp;ENCODEURL(C2)),"//QuoteApiModel/Data/LastPrice")
     </b>
    </p>
   </li>
  </ol>
 </section>
 <section aria-labelledby="ID0EDF" class="ocpSection">
  <h2 class="" id="ID0EDF">
   Need more help?
  </h2>
  <p>
   You can always ask an expert in the
   <a class="ocpExternalLink" data-bi-type="anchor" href="https://techcommunity.microsoft.com/t5/Excel/ct-p/Excel_Cat" target="_blank">
    Excel Tech Community
   </a>
   or get support in
   <a class="ocpExternalLink" data-bi-type="anchor" href="https://answers.microsoft.com/lang/msoffice/forum/msoffice_excel" target="_blank">
    Communities
   </a>
   .
  </p>
 </section>
 <section aria-labelledby="ID0EDD" class="ocpSection">
  <h2 class="" id="ID0EDD">
   See Also
  </h2>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/encodeurl-function-07c7fb90-7c60-4bff-8687-fac50fe33d0e">
    ENCODEURL function
   </a>
  </p>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/webservice-function-0546a35a-ecc6-4739-aed7-c0b7ce1562c4">
    WEBSERVICE function
   </a>
  </p>
  <p>
  </p>
 </section>
</article>
