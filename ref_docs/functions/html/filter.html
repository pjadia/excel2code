<article class="ocpArticleContent">
 <section class="ocpIntroduction">
  <p>
   The
   <b class="ocpLegacyBold">
    FILTER
   </b>
   function allows you to filter a range of data based on criteria you define.
  </p>
  <div class="ocpVideo" data-channel="ALTENUS_MS_OFFICE" data-llcc="en-us" data-player="ocvideo" data-videoid="RE2IVV4" data-videotitle="FILTER function" data-videotype="single" id="ocpVideo1">
   <universal-media-player options='{"partnerName":"SupportService","autoplay":false,"reporting":false,"language":"en-us","title":"FILTER function","poster":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-10489260-8a40-4642-a9dc-054e93f57a59/thumbnail_w800.png","sources":[{"type":"MP4","quality":"HQ","src":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-10489260-8a40-4642-a9dc-054e93f57a59/video_1001_1730393859522_1920x1080.mp4"},{"type":"MP4","quality":"HD","src":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-10489260-8a40-4642-a9dc-054e93f57a59/video_1001_1730393859522_1280x720.mp4"},{"type":"MP4","quality":"LO","src":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-10489260-8a40-4642-a9dc-054e93f57a59/video_1001_1730393859522_640x360.mp4"},{"type":"DASH","src":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-10489260-8a40-4642-a9dc-054e93f57a59/video_1001_1730393859522.mpd"},{"type":"HLS","src":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-10489260-8a40-4642-a9dc-054e93f57a59/video_1001_1730393859522_master.m3u8"}],"ccFiles":[{"url":"https://videoencodingpublic-hgeaeyeba8gycee3.b01.azurefd.net/public-10489260-8a40-4642-a9dc-054e93f57a59/en_us_en-us.vtt","locale":"en-us","ccType":"VTT"}]}'>
    <picture>
     <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=avif&amp;w=320 320w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=avif&amp;w=480 480w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=avif&amp;w=640 640w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=avif&amp;w=800 800w" type="image/avif"/>
     <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=webp&amp;w=320 320w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=webp&amp;w=480 480w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=webp&amp;w=640 640w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=webp&amp;w=800 800w" type="image/webp"/>
     <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=jpeg&amp;w=320 320w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=jpeg&amp;w=480 480w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=jpeg&amp;w=640 640w,        /images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
     <img alt="Your browser does not support video. Install Microsoft Silverlight, Adobe Flash Player, or Internet Explorer 9." class="fluentImage" loading="lazy" src="/images/en-us/4873755a-8b1e-497e-bc54-101d1e75d3e7" style="aspect-ratio: 960/540" width="960"/>
    </picture>
   </universal-media-player>
  </div>
  <p>
   In the following example we used the formula
   <b class="ocpLegacyBold">
    =FILTER(A5:D20,C5:C20=H2,"")
   </b>
   to return all records for Apple, as selected in cell H2, and if there are no apples, return an empty string ("").
  </p>
  <p>
   <picture>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/8998045d-ad20-4690-b3d0-deb12b75a3dd?format=avif&amp;w=320 320w,        /images/en-us/8998045d-ad20-4690-b3d0-deb12b75a3dd?format=avif&amp;w=480 480w,        /images/en-us/8998045d-ad20-4690-b3d0-deb12b75a3dd?format=avif&amp;w=640 640w,        /images/en-us/8998045d-ad20-4690-b3d0-deb12b75a3dd?format=avif&amp;w=800 800w" type="image/avif"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/8998045d-ad20-4690-b3d0-deb12b75a3dd?format=webp&amp;w=320 320w,        /images/en-us/8998045d-ad20-4690-b3d0-deb12b75a3dd?format=webp&amp;w=480 480w,        /images/en-us/8998045d-ad20-4690-b3d0-deb12b75a3dd?format=webp&amp;w=640 640w,        /images/en-us/8998045d-ad20-4690-b3d0-deb12b75a3dd?format=webp&amp;w=800 800w" type="image/webp"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/8998045d-ad20-4690-b3d0-deb12b75a3dd?format=jpeg&amp;w=320 320w,        /images/en-us/8998045d-ad20-4690-b3d0-deb12b75a3dd?format=jpeg&amp;w=480 480w,        /images/en-us/8998045d-ad20-4690-b3d0-deb12b75a3dd?format=jpeg&amp;w=640 640w,        /images/en-us/8998045d-ad20-4690-b3d0-deb12b75a3dd?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
    <img alt="FILTER function - Filter Region by Product (Apple)" class="fluentImage" loading="lazy" src="/images/en-us/8998045d-ad20-4690-b3d0-deb12b75a3dd" style="aspect-ratio: 520/433" width="520"/>
   </picture>
  </p>
 </section>
 <div class="ocpSection">
  <h2 class="ocpExpandoHead">
   <button aria-controls="ID0EJ-panel" aria-expanded="false" class="expandoButtonLink" id="ID0EJ-button" ms.interactiontype="11" type="button">
    <div aria-hidden="true" class="ocpExpandoHeadChevronContainer">
     <i class="ms-Icon--expandoCollapsed ocpExpander" role="none">
     </i>
    </div>
    <div class="ocpExpandoHeadTitleContainer" role="none">
     Syntax
    </div>
   </button>
  </h2>
  <div aria-labelledby="ID0EJ-button" class="ocpebw" id="ID0EJ-panel" role="region">
   <div class="ocpExpandoBody">
    <p>
     The FILTER function filters an array based on a Boolean (True/False) array.
    </p>
    <p>
     <b class="ocpLegacyBold">
      =FILTER(array,include,[if_empty])
     </b>
    </p>
    <table aria-label="" class="banded">
     <tbody>
      <tr>
       <td>
        <p>
         Argument
        </p>
       </td>
       <td>
        <p>
         Description
        </p>
       </td>
      </tr>
      <tr>
       <td>
        <p>
         <b class="ocpLegacyBold">
          array
         </b>
        </p>
        <p>
         Required
        </p>
       </td>
       <td>
        <p>
         The array, or range to filter
        </p>
       </td>
      </tr>
      <tr>
       <td>
        <p>
         <b class="ocpLegacyBold">
          include
         </b>
        </p>
        <p>
         Required
        </p>
       </td>
       <td>
        <p>
         A Boolean array whose height or width is the same as the array
        </p>
       </td>
      </tr>
      <tr>
       <td>
        <p>
         <b class="ocpLegacyBold">
          [if_empty]
         </b>
        </p>
        <p>
         Optional
        </p>
       </td>
       <td>
        <p>
         The value to return if all values in the included array are empty (filter returns nothing)
        </p>
       </td>
      </tr>
     </tbody>
    </table>
    <div class="ocpAlert">
     <p class="ocpAlertSection">
      <b class="ocpNote">
       Notes:
      </b>
     </p>
     <ul class="ocpAlertSectionListContainer">
      <li>
       <p>
        An array can be thought of as a row of values, a column of values, or a combination of rows and columns of values. In the example above, the source array for our FILTER formula is range A5:D20.
       </p>
      </li>
      <li>
       <p>
        The FILTER function will return an array, which will spill if it's the final result of a formula. This means that Excel will dynamically create the appropriate sized array range when you press
        <b class="ocpUI">
         ENTER
        </b>
        . If your supporting data is in an
        <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/overview-of-excel-tables-7ab0bb7d-3a9e-4b56-a3c9-6c94334e492c">
         Excel table
        </a>
        , then the array will automatically resize as you add or remove data from your array range if you're using
        <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/using-structured-references-with-excel-tables-f5ed2452-2337-4f71-bed3-c8ae6d2b276e">
         structured references
        </a>
        . For more details, see this article on
        <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/dynamic-array-formulas-and-spilled-array-behavior-205c6b06-03ba-4151-89a1-87a7eb36e531">
         spilled array behavior
        </a>
        .
       </p>
      </li>
      <li>
       <p>
        If your dataset has the potential of returning an empty value, then use the 3rd argument (
        <b class="ocpLegacyBold">
         [if_empty]
        </b>
        ). Otherwise, a
        <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/how-to-correct-a-calc-error-d6ee03c5-daf6-426a-8df5-4b284730ab1b">
         #CALC! error
        </a>
        will result, as Excel does not currently support empty arrays.
       </p>
      </li>
      <li>
       <p>
        If any value of the
        <b class="ocpLegacyBold">
         include
        </b>
        argument is an error (#N/A, #VALUE, etc.) or cannot be converted to a Boolean, the FILTER function will return an error.
       </p>
      </li>
      <li>
       <p>
        Excel has limited support for dynamic arrays between workbooks, and this scenario is only supported when
        <b class="ocpLegacyBold">
         both
        </b>
        workbooks are open. If you close the source workbook, any linked dynamic array formulas will return a
        <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/how-to-correct-a-ref-error-822c8e46-e610-4d02-bf29-ec4b8c5ff4be">
         #REF! error
        </a>
        when they are refreshed.
       </p>
      </li>
     </ul>
    </div>
   </div>
  </div>
 </div>
 <section aria-labelledby="ID0EDH" class="ocpSection">
  <h2 class="" id="ID0EDH">
   Examples
  </h2>
  <p>
   <b class="ocpLegacyBold">
    FILTER used to return multiple criteria
   </b>
  </p>
  <p>
   In this case, we're using the multiplication operator (*) to return all values in our array range (A5:D20) that have Apples
   <b class="ocpLegacyBold">
    AND
   </b>
   are in the East region:
   <b class="ocpLegacyBold">
    =FILTER(A5:D20,(C5:C20=H1)*(A5:A20=H2),"")
   </b>
   .
  </p>
  <p>
   <picture>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/b51b72d9-7fe6-4274-aec5-05a7f0a22ca0?format=avif&amp;w=320 320w,        /images/en-us/b51b72d9-7fe6-4274-aec5-05a7f0a22ca0?format=avif&amp;w=480 480w,        /images/en-us/b51b72d9-7fe6-4274-aec5-05a7f0a22ca0?format=avif&amp;w=640 640w,        /images/en-us/b51b72d9-7fe6-4274-aec5-05a7f0a22ca0?format=avif&amp;w=800 800w" type="image/avif"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/b51b72d9-7fe6-4274-aec5-05a7f0a22ca0?format=webp&amp;w=320 320w,        /images/en-us/b51b72d9-7fe6-4274-aec5-05a7f0a22ca0?format=webp&amp;w=480 480w,        /images/en-us/b51b72d9-7fe6-4274-aec5-05a7f0a22ca0?format=webp&amp;w=640 640w,        /images/en-us/b51b72d9-7fe6-4274-aec5-05a7f0a22ca0?format=webp&amp;w=800 800w" type="image/webp"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/b51b72d9-7fe6-4274-aec5-05a7f0a22ca0?format=jpeg&amp;w=320 320w,        /images/en-us/b51b72d9-7fe6-4274-aec5-05a7f0a22ca0?format=jpeg&amp;w=480 480w,        /images/en-us/b51b72d9-7fe6-4274-aec5-05a7f0a22ca0?format=jpeg&amp;w=640 640w,        /images/en-us/b51b72d9-7fe6-4274-aec5-05a7f0a22ca0?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
    <img alt="Using FILTER with the multiplication operator (*) to return all values in our array range (A5:D20) that have Apples AND are in the East region." class="fluentImage" loading="lazy" src="/images/en-us/b51b72d9-7fe6-4274-aec5-05a7f0a22ca0" style="aspect-ratio: 329/222" width="329"/>
   </picture>
  </p>
  <p>
   <b class="ocpLegacyBold">
    FILTER used to return multiple criteria and sort
   </b>
  </p>
  <p>
   In this case, we're using the previous FILTER function with the SORT function to return all values in our array range (A5:D20) that have Apples
   <b class="ocpLegacyBold">
    AND
   </b>
   are in the East region, and then sort Units in descending order:
   <b class="ocpLegacyBold">
    =SORT(FILTER(A5:D20,(C5:C20=H1)*(A5:A20=H2),""),4,-1)
   </b>
  </p>
  <p>
   <picture>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/aaf31220-3667-4676-8d9d-2814a3cb0dc4?format=avif&amp;w=320 320w,        /images/en-us/aaf31220-3667-4676-8d9d-2814a3cb0dc4?format=avif&amp;w=480 480w,        /images/en-us/aaf31220-3667-4676-8d9d-2814a3cb0dc4?format=avif&amp;w=640 640w,        /images/en-us/aaf31220-3667-4676-8d9d-2814a3cb0dc4?format=avif&amp;w=800 800w" type="image/avif"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/aaf31220-3667-4676-8d9d-2814a3cb0dc4?format=webp&amp;w=320 320w,        /images/en-us/aaf31220-3667-4676-8d9d-2814a3cb0dc4?format=webp&amp;w=480 480w,        /images/en-us/aaf31220-3667-4676-8d9d-2814a3cb0dc4?format=webp&amp;w=640 640w,        /images/en-us/aaf31220-3667-4676-8d9d-2814a3cb0dc4?format=webp&amp;w=800 800w" type="image/webp"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/aaf31220-3667-4676-8d9d-2814a3cb0dc4?format=jpeg&amp;w=320 320w,        /images/en-us/aaf31220-3667-4676-8d9d-2814a3cb0dc4?format=jpeg&amp;w=480 480w,        /images/en-us/aaf31220-3667-4676-8d9d-2814a3cb0dc4?format=jpeg&amp;w=640 640w,        /images/en-us/aaf31220-3667-4676-8d9d-2814a3cb0dc4?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
    <img alt="Using FILTER with the SORT function to return all values in our array range (A5:D20) that have Apples AND are in the East region, and then sort Units in descending order." class="fluentImage" loading="lazy" src="/images/en-us/aaf31220-3667-4676-8d9d-2814a3cb0dc4" style="aspect-ratio: 392/226" width="392"/>
   </picture>
  </p>
  <p>
   In this case, we're using the FILTER function with the addition operator (+) to return all values in our array range (A5:D20) that have Apples
   <b class="ocpLegacyBold">
    OR
   </b>
   are in the East region, and then sort Units in descending order:
   <b class="ocpLegacyBold">
    =SORT(FILTER(A5:D20,(C5:C20=H1)+(A5:A20=H2),""),4,-1)
   </b>
   .
  </p>
  <p>
   <picture>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/5e12f146-fc0b-4f12-af70-247fe55acaa3?format=avif&amp;w=320 320w,        /images/en-us/5e12f146-fc0b-4f12-af70-247fe55acaa3?format=avif&amp;w=480 480w,        /images/en-us/5e12f146-fc0b-4f12-af70-247fe55acaa3?format=avif&amp;w=640 640w,        /images/en-us/5e12f146-fc0b-4f12-af70-247fe55acaa3?format=avif&amp;w=800 800w" type="image/avif"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/5e12f146-fc0b-4f12-af70-247fe55acaa3?format=webp&amp;w=320 320w,        /images/en-us/5e12f146-fc0b-4f12-af70-247fe55acaa3?format=webp&amp;w=480 480w,        /images/en-us/5e12f146-fc0b-4f12-af70-247fe55acaa3?format=webp&amp;w=640 640w,        /images/en-us/5e12f146-fc0b-4f12-af70-247fe55acaa3?format=webp&amp;w=800 800w" type="image/webp"/>
    <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/5e12f146-fc0b-4f12-af70-247fe55acaa3?format=jpeg&amp;w=320 320w,        /images/en-us/5e12f146-fc0b-4f12-af70-247fe55acaa3?format=jpeg&amp;w=480 480w,        /images/en-us/5e12f146-fc0b-4f12-af70-247fe55acaa3?format=jpeg&amp;w=640 640w,        /images/en-us/5e12f146-fc0b-4f12-af70-247fe55acaa3?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
    <img alt="FILTER and SORT together - Filter by Product (Apple) OR by Region (East)" class="fluentImage" loading="lazy" src="/images/en-us/5e12f146-fc0b-4f12-af70-247fe55acaa3" style="aspect-ratio: 383/280" width="383"/>
   </picture>
  </p>
  <p>
   Notice that none of the functions require
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/switch-between-relative-absolute-and-mixed-references-dfec08cd-ae65-4f56-839e-5f0d8d0baca9">
    absolute references
   </a>
   , since they only exist in one cell, and spill their results to neighboring cells.
  </p>
  <p>
  </p>
 </section>
 <section aria-labelledby="ID0EDF" class="ocpSection">
  <h2 class="" id="ID0EDF">
   Need more help?
  </h2>
  <p>
   You can always ask an expert in the
   <a class="ocpExternalLink" data-bi-type="anchor" href="https://techcommunity.microsoft.com/t5/Excel/ct-p/Excel_Cat" target="_blank">
    Excel Tech Community
   </a>
   or get support in
   <a class="ocpExternalLink" data-bi-type="anchor" href="https://answers.microsoft.com/lang/msoffice/forum/msoffice_excel" target="_blank">
    Communities
   </a>
   .
  </p>
  <p>
  </p>
 </section>
 <section aria-labelledby="ID0EDD" class="ocpSection">
  <h2 class="" id="ID0EDD">
   See Also
  </h2>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/randarray-function-21261e55-3bec-4885-86a6-8b0a47fd4d33">
    RANDARRAY function
   </a>
  </p>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/sequence-function-57467a98-57e0-4817-9f14-2eb78519ca90">
    SEQUENCE function
   </a>
  </p>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/sort-function-22f63bd0-ccc8-492f-953d-c20e8e44b86c">
    SORT function
   </a>
  </p>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/sortby-function-cd2d7a62-1b93-435c-b561-d6a35134f28f">
    SORTBY function
   </a>
  </p>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/unique-function-c5ab87fd-30a3-4ce9-9d1a-40204fb85e1e">
    UNIQUE function
   </a>
  </p>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/how-to-correct-a-spill-error-ffe0f555-b479-4a17-a6e2-ef9cc9ad4023">
    #SPILL! errors in Excel
   </a>
  </p>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/dynamic-array-formulas-and-spilled-array-behavior-205c6b06-03ba-4151-89a1-87a7eb36e531">
    Dynamic arrays and spilled array behavior
   </a>
  </p>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/implicit-intersection-operator-ce3be07b-0101-4450-a24e-c1c999be2b34">
    Implicit intersection operator: @
   </a>
  </p>
 </section>
</article>
