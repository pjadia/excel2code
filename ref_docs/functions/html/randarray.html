<article class="ocpArticleContent">
 <section class="ocpIntroduction">
  <p>
   The
   <b class="ocpLegacyBold">
    RANDARRAY
   </b>
   function returns an array of random numbers. You can specify the number of rows and columns to fill, minimum and maximum values, and whether to return whole numbers or decimal values.
  </p>
  <p>
   In the following examples, we created an array that's 5 rows tall by 3 columns wide. The first returns a random set of values between 0 and 1, which is RANDARRAY's default behavior. The next returns a series of random decimal values between 1 and 100. Finally, the third example returns a series of random whole numbers between 1 and 100.
  </p>
  <div class="supARG" data-bi-view="Grid 1x3">
   <div class="supARG-row">
    <div class="supARG-column-1-3" data-bi-compnm="row-1,col-1" data-bi-view="Grid 1x3">
     <p>
      <picture>
       <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/0b87cf81-e417-48db-9217-4ccf51c4c5c4?format=avif&amp;w=320 320w,        /images/en-us/0b87cf81-e417-48db-9217-4ccf51c4c5c4?format=avif&amp;w=480 480w,        /images/en-us/0b87cf81-e417-48db-9217-4ccf51c4c5c4?format=avif&amp;w=640 640w,        /images/en-us/0b87cf81-e417-48db-9217-4ccf51c4c5c4?format=avif&amp;w=800 800w" type="image/avif"/>
       <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/0b87cf81-e417-48db-9217-4ccf51c4c5c4?format=webp&amp;w=320 320w,        /images/en-us/0b87cf81-e417-48db-9217-4ccf51c4c5c4?format=webp&amp;w=480 480w,        /images/en-us/0b87cf81-e417-48db-9217-4ccf51c4c5c4?format=webp&amp;w=640 640w,        /images/en-us/0b87cf81-e417-48db-9217-4ccf51c4c5c4?format=webp&amp;w=800 800w" type="image/webp"/>
       <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/0b87cf81-e417-48db-9217-4ccf51c4c5c4?format=jpeg&amp;w=320 320w,        /images/en-us/0b87cf81-e417-48db-9217-4ccf51c4c5c4?format=jpeg&amp;w=480 480w,        /images/en-us/0b87cf81-e417-48db-9217-4ccf51c4c5c4?format=jpeg&amp;w=640 640w,        /images/en-us/0b87cf81-e417-48db-9217-4ccf51c4c5c4?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
       <img alt="RANDARRAY function in Excel. RANDARRAY(5,3) returns random values between 0 and 1 in an array that's 5 rows tall by 3 columns wide." class="fluentImage" loading="lazy" src="/images/en-us/0b87cf81-e417-48db-9217-4ccf51c4c5c4" style="aspect-ratio: 215/197" width="215"/>
      </picture>
     </p>
    </div>
    <div class="supARG-column-1-3" data-bi-compnm="row-1,col-2" data-bi-view="Grid 1x3">
     <p>
      <picture>
       <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/4edd8c67-5084-4970-8af2-7f0703d2ab95?format=avif&amp;w=320 320w,        /images/en-us/4edd8c67-5084-4970-8af2-7f0703d2ab95?format=avif&amp;w=480 480w,        /images/en-us/4edd8c67-5084-4970-8af2-7f0703d2ab95?format=avif&amp;w=640 640w,        /images/en-us/4edd8c67-5084-4970-8af2-7f0703d2ab95?format=avif&amp;w=800 800w" type="image/avif"/>
       <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/4edd8c67-5084-4970-8af2-7f0703d2ab95?format=webp&amp;w=320 320w,        /images/en-us/4edd8c67-5084-4970-8af2-7f0703d2ab95?format=webp&amp;w=480 480w,        /images/en-us/4edd8c67-5084-4970-8af2-7f0703d2ab95?format=webp&amp;w=640 640w,        /images/en-us/4edd8c67-5084-4970-8af2-7f0703d2ab95?format=webp&amp;w=800 800w" type="image/webp"/>
       <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/4edd8c67-5084-4970-8af2-7f0703d2ab95?format=jpeg&amp;w=320 320w,        /images/en-us/4edd8c67-5084-4970-8af2-7f0703d2ab95?format=jpeg&amp;w=480 480w,        /images/en-us/4edd8c67-5084-4970-8af2-7f0703d2ab95?format=jpeg&amp;w=640 640w,        /images/en-us/4edd8c67-5084-4970-8af2-7f0703d2ab95?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
       <img alt="RANDARRAY function with Min, Max &amp; Decimal arguments" class="fluentImage" loading="lazy" src="/images/en-us/4edd8c67-5084-4970-8af2-7f0703d2ab95" style="aspect-ratio: 215/195" width="215"/>
      </picture>
     </p>
    </div>
    <div class="supARG-column-1-3" data-bi-compnm="row-1,col-3" data-bi-view="Grid 1x3">
     <p>
      <picture>
       <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/ac418fd1-0a47-41a3-845f-a6297c8fd0e3?format=avif&amp;w=320 320w,        /images/en-us/ac418fd1-0a47-41a3-845f-a6297c8fd0e3?format=avif&amp;w=480 480w,        /images/en-us/ac418fd1-0a47-41a3-845f-a6297c8fd0e3?format=avif&amp;w=640 640w,        /images/en-us/ac418fd1-0a47-41a3-845f-a6297c8fd0e3?format=avif&amp;w=800 800w" type="image/avif"/>
       <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/ac418fd1-0a47-41a3-845f-a6297c8fd0e3?format=webp&amp;w=320 320w,        /images/en-us/ac418fd1-0a47-41a3-845f-a6297c8fd0e3?format=webp&amp;w=480 480w,        /images/en-us/ac418fd1-0a47-41a3-845f-a6297c8fd0e3?format=webp&amp;w=640 640w,        /images/en-us/ac418fd1-0a47-41a3-845f-a6297c8fd0e3?format=webp&amp;w=800 800w" type="image/webp"/>
       <source sizes="(max-width: 480px) 320px, (max-width: 768px) 480px, (max-width: 1024px) 640px, 800px" srcset="/images/en-us/ac418fd1-0a47-41a3-845f-a6297c8fd0e3?format=jpeg&amp;w=320 320w,        /images/en-us/ac418fd1-0a47-41a3-845f-a6297c8fd0e3?format=jpeg&amp;w=480 480w,        /images/en-us/ac418fd1-0a47-41a3-845f-a6297c8fd0e3?format=jpeg&amp;w=640 640w,        /images/en-us/ac418fd1-0a47-41a3-845f-a6297c8fd0e3?format=jpeg&amp;w=800 800w" type="image/jpeg"/>
       <img alt="RANDARRAY function with Min, Max &amp; Whole number arguments" class="fluentImage" loading="lazy" src="/images/en-us/ac418fd1-0a47-41a3-845f-a6297c8fd0e3" style="aspect-ratio: 212/195" width="212"/>
      </picture>
     </p>
    </div>
   </div>
  </div>
 </section>
 <section aria-labelledby="ID0EDH" class="ocpSection">
  <h2 class="" id="ID0EDH">
   Syntax
  </h2>
  <p>
   <b class="ocpLegacyBold">
    =RANDARRAY([rows],[columns],[min],[max],[whole_number])
   </b>
  </p>
  <table aria-label="" class="banded">
   <thead>
    <tr>
     <th>
      <p>
       Argument
      </p>
     </th>
     <th>
      <p>
       Description
      </p>
     </th>
    </tr>
   </thead>
   <tbody>
    <tr>
     <td>
      <p>
       <b class="ocpLegacyBold">
        [rows]
       </b>
      </p>
      <p>
       Optional
      </p>
     </td>
     <td>
      <p>
       The number of rows to be returned
      </p>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       <b class="ocpLegacyBold">
        [columns]
       </b>
      </p>
      <p>
       Optional
      </p>
     </td>
     <td>
      <p>
       The number of columns to be returned
      </p>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       <b class="ocpLegacyBold">
        [min]
       </b>
      </p>
      <p>
       Optional
      </p>
     </td>
     <td>
      <p>
       The minimum number you would like returned
      </p>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       <b class="ocpLegacyBold">
        [max]
       </b>
      </p>
      <p>
       Optional
      </p>
     </td>
     <td>
      <p>
       The maximum number you would like returned
      </p>
     </td>
    </tr>
    <tr>
     <td>
      <p>
       <b class="ocpLegacyBold">
        [integer]
       </b>
      </p>
      <p>
       Optional
      </p>
     </td>
     <td>
      <p>
       Return a whole number or a decimal value
      </p>
      <ul>
       <li>
        <p>
         TRUE for a whole number
        </p>
       </li>
       <li>
        <p>
         FALSE for a decimal number
        </p>
       </li>
      </ul>
     </td>
    </tr>
   </tbody>
  </table>
  <div class="ocpAlert">
   <p class="ocpAlertSection">
    <b class="ocpNote">
     Notes:
    </b>
   </p>
   <ul class="ocpAlertSectionListContainer">
    <li>
     <p>
      If you don't input a row or column argument, RANDARRAY will return a single value between 0 and 1.
     </p>
    </li>
    <li>
     <p>
      If you don't input a minimum or maximum value argument, RANDARRAY will default to 0 and 1 respectively.
     </p>
    </li>
    <li>
     <p>
      The minimum number argument must be less than the maximum number, otherwise RANDARRAY will return a #VALUE! error.
     </p>
    </li>
    <li>
     <p>
      If you don't input a whole_number argument, RANDARRY will default to FALSE, or decimal value.
     </p>
    </li>
    <li>
     <p>
      The RANDARRAY function will return an array, which will spill if it's the final result of a formula. This means that Excel will dynamically create the appropriate sized array range when you press
      <b class="ocpUI">
       ENTER
      </b>
      . If your supporting data is in an
      <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/overview-of-excel-tables-7ab0bb7d-3a9e-4b56-a3c9-6c94334e492c">
       Excel table
      </a>
      , then the array will automatically resize as you add or remove data from your array range if you're using
      <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/using-structured-references-with-excel-tables-f5ed2452-2337-4f71-bed3-c8ae6d2b276e">
       structured references
      </a>
      . For more details, see this article on
      <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/dynamic-array-formulas-and-spilled-array-behavior-205c6b06-03ba-4151-89a1-87a7eb36e531">
       spilled array behavior
      </a>
      .
     </p>
    </li>
    <li>
     <p>
      RANDARRAY is different from the
      <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/rand-function-4cbfa695-8869-4788-8d90-021ea9f5be73">
       RAND
      </a>
      function in that RAND does not return an array, so RAND would need to be copied to the entire range.
     </p>
    </li>
    <li>
     <p>
      An array can be thought of as a row of values, a column of values, or a combination of rows and columns of values. In the example above, the array for our RANDARRAY formula is range D2:F6, or 5 rows by 3 columns.
     </p>
    </li>
    <li>
     <p>
      Excel has limited support for dynamic arrays between workbooks, and this scenario is only supported when
      <b class="ocpLegacyBold">
       both
      </b>
      workbooks are open. If you close the source workbook, any linked dynamic array formulas will return a
      <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/how-to-correct-a-ref-error-822c8e46-e610-4d02-bf29-ec4b8c5ff4be">
       #REF! error
      </a>
      when they are refreshed.
     </p>
    </li>
   </ul>
  </div>
 </section>
 <section aria-labelledby="ID0EDF" class="ocpSection">
  <h2 class="" id="ID0EDF">
   Need more help?
  </h2>
  <p>
   You can always ask an expert in the
   <a class="ocpExternalLink" data-bi-type="anchor" href="https://techcommunity.microsoft.com/t5/Excel/ct-p/Excel_Cat" target="_blank">
    Excel Tech Community
   </a>
   or get support in
   <a class="ocpExternalLink" data-bi-type="anchor" href="https://answers.microsoft.com/lang/msoffice/forum/msoffice_excel" target="_blank">
    Communities
   </a>
   .
  </p>
  <p>
  </p>
 </section>
 <section aria-labelledby="ID0EDD" class="ocpSection">
  <h2 class="" id="ID0EDD">
   See also
  </h2>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/filter-function-f4f7cb66-82eb-4767-8f7c-4877ad80c759">
    FILTER function
   </a>
  </p>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/sequence-function-57467a98-57e0-4817-9f14-2eb78519ca90">
    SEQUENCE function
   </a>
  </p>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/sort-function-22f63bd0-ccc8-492f-953d-c20e8e44b86c">
    SORT function
   </a>
  </p>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/sortby-function-cd2d7a62-1b93-435c-b561-d6a35134f28f">
    SORTBY function
   </a>
  </p>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/unique-function-c5ab87fd-30a3-4ce9-9d1a-40204fb85e1e">
    UNIQUE function
   </a>
  </p>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/how-to-correct-a-spill-error-ffe0f555-b479-4a17-a6e2-ef9cc9ad4023">
    #SPILL! errors in Excel
   </a>
  </p>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/dynamic-array-formulas-and-spilled-array-behavior-205c6b06-03ba-4151-89a1-87a7eb36e531">
    Dynamic arrays and spilled array behavior
   </a>
  </p>
  <p>
   <a class="ocpArticleLink" data-bi-type="anchor" href="/en-us/office/implicit-intersection-operator-ce3be07b-0101-4450-a24e-c1c999be2b34">
    Implicit intersection operator: @
   </a>
  </p>
 </section>
</article>
